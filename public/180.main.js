(self.webpackChunkintroexpress=self.webpackChunkintroexpress||[]).push([[180],{8133:t=>{t.exports=function(t){var r=[];return t.replace(s,(function(t,s,n){var a=s.toLowerCase();for(n=function(t){var e=t.match(i);return e?e.map(Number):[]}(n),"m"==a&&n.length>2&&(r.push([s].concat(n.splice(0,2))),a="l",s="m"==s?"l":"L");;){if(n.length==e[a])return n.unshift(s),r.push(n);if(n.length<e[a])throw new Error("malformed path data");r.push([s].concat(n.splice(0,e[a])))}})),r};var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=/([astvzqmhlc])([^astvzqmhlc]*)/gi,i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},4732:(t,e,s)=>{"use strict";var i=s(8507);class r{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this._cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:i}=this._resizeTo;t=s,e=i}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}r.extension=i.Ag.Application;var n=s(4458),a=s(7309);class o{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,n.d.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?a.R.shared:new a.R,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}o.extension=i.Ag.Application,i.XO.add(r),i.XO.add(o)},9935:(t,e,s)=>{"use strict";var i=s(8507);class r{constructor(t){this._renderer=t}push(t,e,s){this._renderer.renderPipes.batch.break(s),s.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:e,filterEffect:t})}pop(t,e,s){this._renderer.renderPipes.batch.break(s),s.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(t){"pushFilter"===t.action?this._renderer.filter.push(t):"popFilter"===t.action&&this._renderer.filter.pop()}destroy(){this._renderer=null}}r.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"filter"};var n=s(9313),a=s(5101),o=s(3513),h=s(6011),l=s(5811),c=s(4492),u=s(2437),d=s(5099),p=s(9636),f=s(2208);const g=new n.u;function x(t,e){return e.clear(),m(t,e),e.isValid||e.set(0,0,0,0),t.renderGroup?e.applyMatrix(t.renderGroup.localTransform):e.applyMatrix(t.parentRenderGroup.worldTransform),e}function m(t,e){if(7!==t.localDisplayStatus||!t.measurable)return;const s=!!t.effects.length;let i=e;if((t.renderGroup||s)&&(i=f.o.get().clear()),t.boundsArea)e.addRect(t.boundsArea,t.worldTransform);else{if(t.renderPipeId){const e=t.bounds;i.addFrame(e.minX,e.minY,e.maxX,e.maxY,t.groupTransform)}const e=t.children;for(let t=0;t<e.length;t++)m(e[t],i)}if(s){let s=!1;for(let e=0;e<t.effects.length;e++)t.effects[e].addBounds&&(s||(s=!0,i.applyMatrix(t.parentRenderGroup.worldTransform)),t.effects[e].addBounds(i,!0));s&&(i.applyMatrix(t.parentRenderGroup.worldTransform.copyTo(g).invert()),e.addBounds(i,t.relativeGroupTransform)),e.addBounds(i),f.o.return(i)}else t.renderGroup&&(e.addBounds(i,t.relativeGroupTransform),f.o.return(i))}var _=s(268);const y=new h.V({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),location:0,format:"float32x2",stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class b{constructor(t){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new l.k({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new o.T({}),this.renderer=t}get activeBackTexture(){return this._activeFilterData?.backTexture}push(t){const e=this.renderer,s=t.filterEffect.filters;this._filterStack[this._filterStackIndex]||(this._filterStack[this._filterStackIndex]=this._getFilterData());const i=this._filterStack[this._filterStackIndex];if(this._filterStackIndex++,0===s.length)return void(i.skip=!0);const r=i.bounds;t.renderables?function(t,e){e.clear();const s=e.matrix;for(let s=0;s<t.length;s++){const i=t[s];i.globalDisplayStatus<7||(e.matrix=i.worldTransform,i.addBounds(e))}e.matrix=s}(t.renderables,r):t.filterEffect.filterArea?(r.clear(),r.addRect(t.filterEffect.filterArea),r.applyMatrix(t.container.worldTransform)):x(t.container,r);const n=e.renderTarget.rootRenderTarget.colorTexture.source;let a=n._resolution,o=0,h=n.antialias,l=!1,c=!1;for(let t=0;t<s.length;t++){const i=s[t];if(a=Math.min(a,i.resolution),o+=i.padding,"inherit"!==i.antialias&&(h="on"===i.antialias),!(i.compatibleRenderers&e.type)){c=!1;break}if(i.blendRequired&&!(e.backBuffer?.useBackBuffer??1)){(0,_.R)("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),c=!1;break}c=i.enabled||c,l=l||i.blendRequired}if(!c)return void(i.skip=!0);const d=e.renderTarget.rootViewPort;r.scale(a).fitBounds(0,d.width,0,d.height).scale(1/a).pad(o).ceil(),r.isPositive?(i.skip=!1,i.bounds=r,i.blendRequired=l,i.container=t.container,i.filterEffect=t.filterEffect,i.previousRenderSurface=e.renderTarget.renderSurface,i.inputTexture=u.W.getOptimalTexture(r.width,r.height,a,h),e.renderTarget.bind(i.inputTexture,!0),e.globalUniforms.push({offset:r})):i.skip=!0}pop(){const t=this.renderer;this._filterStackIndex--;const e=this._filterStack[this._filterStackIndex];if(e.skip)return;this._activeFilterData=e;const s=e.inputTexture,i=e.bounds;let r=c.g.EMPTY;if(t.renderTarget.finishRenderPass(),e.blendRequired){const s=this._filterStackIndex>0?this._filterStack[this._filterStackIndex-1].bounds:null,n=t.renderTarget.getRenderTarget(e.previousRenderSurface);r=this.getBackTexture(n,i,s)}e.backTexture=r;const n=e.filterEffect.filters;if(this._globalFilterBindGroup.setResource(s.source.style,2),this._globalFilterBindGroup.setResource(r.source,3),t.globalUniforms.pop(),1===n.length)n[0].apply(this,s,e.previousRenderSurface,!1),u.W.returnTexture(s);else{let t=e.inputTexture,s=u.W.getOptimalTexture(i.width,i.height,t.source._resolution,!1),r=0;for(r=0;r<n.length-1;++r){n[r].apply(this,t,s,!0);const e=t;t=s,s=e}n[r].apply(this,t,e.previousRenderSurface,!1),u.W.returnTexture(t),u.W.returnTexture(s)}e.blendRequired&&u.W.returnTexture(r)}getBackTexture(t,e,s){const i=t.colorTexture.source._resolution,r=u.W.getOptimalTexture(e.width,e.height,i,!1);let n=e.minX,a=e.minY;s&&(n-=s.minX,a-=s.minY),n=Math.floor(n*i),a=Math.floor(a*i);const o=Math.ceil(e.width*i),h=Math.ceil(e.height*i);return this.renderer.renderTarget.copyToTexture(t,r,{x:n,y:a},{width:o,height:h},{x:0,y:0}),r}applyFilter(t,e,s,i){const r=this.renderer,n=this._filterStack[this._filterStackIndex],o=n.bounds,h=a.b.shared,l=n.previousRenderSurface===s;let u=this.renderer.renderTarget.rootRenderTarget.colorTexture.source._resolution,p=this._filterStackIndex-1;for(;p>0&&this._filterStack[p].skip;)--p;p>0&&(u=this._filterStack[p].inputTexture.source._resolution);const f=this._filterGlobalUniforms,g=f.uniforms,x=g.uOutputFrame,m=g.uInputSize,_=g.uInputPixel,b=g.uInputClamp,S=g.uGlobalFrame,v=g.uOutputTexture;if(l){let t=this._filterStackIndex;for(;t>0;){t--;const e=this._filterStack[this._filterStackIndex-1];if(!e.skip){h.x=e.bounds.minX,h.y=e.bounds.minY;break}}x[0]=o.minX-h.x,x[1]=o.minY-h.y}else x[0]=0,x[1]=0;x[2]=e.frame.width,x[3]=e.frame.height,m[0]=e.source.width,m[1]=e.source.height,m[2]=1/m[0],m[3]=1/m[1],_[0]=e.source.pixelWidth,_[1]=e.source.pixelHeight,_[2]=1/_[0],_[3]=1/_[1],b[0]=.5*_[2],b[1]=.5*_[3],b[2]=e.frame.width*m[2]-.5*_[2],b[3]=e.frame.height*m[3]-.5*_[3];const w=this.renderer.renderTarget.rootRenderTarget.colorTexture;S[0]=h.x*u,S[1]=h.y*u,S[2]=w.source.width*u,S[3]=w.source.height*u;const T=this.renderer.renderTarget.getRenderTarget(s);if(r.renderTarget.bind(s,!!i),s instanceof c.g?(v[0]=s.frame.width,v[1]=s.frame.height):(v[0]=T.width,v[1]=T.height),v[2]=T.isRoot?-1:1,f.update(),r.renderPipes.uniformBatch){const t=r.renderPipes.uniformBatch.getUboResource(f);this._globalFilterBindGroup.setResource(t,0)}else this._globalFilterBindGroup.setResource(f,0);this._globalFilterBindGroup.setResource(e.source,1),this._globalFilterBindGroup.setResource(e.source.style,2),t.groups[0]=this._globalFilterBindGroup,r.encoder.draw({geometry:y,shader:t,state:t._state,topology:"triangle-list"}),r.type===d.W.WEBGL&&r.renderTarget.finishRenderPass()}_getFilterData(){return{skip:!1,inputTexture:null,bounds:new p.c,container:null,filterEffect:null,blendRequired:!1,previousRenderSurface:null}}calculateSpriteMatrix(t,e){const s=this._activeFilterData,i=t.set(s.inputTexture._source.width,0,0,s.inputTexture._source.height,s.bounds.minX,s.bounds.minY),r=e.worldTransform.copyTo(n.u.shared);return r.invert(),i.prepend(r),i.scale(1/e.texture.frame.width,1/e.texture.frame.height),i.translate(e.anchor.x,e.anchor.y),i}}b.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem],name:"filter"},i.XO.add(b),i.XO.add(r)},341:(t,e,s)=>{"use strict";s.d(e,{w:()=>o});var i=s(3513),r=s(4492),n=s(8815);const a={};function o(t,e){let s=0;for(let i=0;i<e;i++)s=31*s+t[i].uid>>>0;return a[s]||function(t,e){const s={};let o=0;h||(h=(0,n.c)());for(let e=0;e<h;e++){const i=e<t.length?t[e]:r.g.EMPTY.source;s[o++]=i.source,s[o++]=i.style}const l=new i.T(s);return a[e]=l,l}(t,s)}let h=0},6040:(t,e,s)=>{"use strict";s.d(e,{n:()=>n});var i=s(5811);const r={};function n(t){let e=r[t];if(e)return e;const s=new Int32Array(t);for(let e=0;e<t;e++)s[e]=e;return e=r[t]=new i.k({uTextures:{value:s,type:"i32",size:t}},{isStatic:!0}),e}},7608:(t,e,s)=>{"use strict";s.d(e,{N:()=>n});var i=s(1761),r=s(9939);const n=new class{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const s=i.e.get().createCanvas();s.width=t,s.height=e;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6);const i=((t=(0,r.U5)(t))<<17)+((e=(0,r.U5)(e))<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let n=this._canvasPool[i].pop();return n||(n=this._createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const{width:e,height:s}=t.canvas,i=(e<<17)+(s<<1);this._canvasPool[i].push(t)}clear(){this._canvasPool={}}}},8928:(t,e,s)=>{"use strict";var i=s(8507),r=s(3428),n=s(7547),a=s(8218),o=s(2760),h=s(4389);class l{constructor(t,e){this.state=n.U.for2d(),this._graphicsBatchesHash=Object.create(null),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){const e=t.context,s=!!this._graphicsBatchesHash[t.uid],i=this.renderer.graphicsContext.updateGpuContext(e);return!(!i.isBatchable&&s===i.isBatchable)}addRenderable(t,e){const s=this.renderer.graphicsContext.updateGpuContext(t.context);t._didGraphicsUpdate&&(t._didGraphicsUpdate=!1,this._rebuild(t)),s.isBatchable?this._addToBatcher(t,e):(this.renderer.renderPipes.batch.break(e),e.add(t))}updateRenderable(t){const e=this._graphicsBatchesHash[t.uid];if(e)for(let t=0;t<e.length;t++){const s=e[t];s.batcher.updateElement(s)}}destroyRenderable(t){this._graphicsBatchesHash[t.uid]&&this._removeBatchForRenderable(t.uid)}execute(t){if(!t.isRenderable)return;const e=this.renderer,s=t.context;if(!e.graphicsContext.getGpuContext(s).batches.length)return;const i=s.customShader||this._adaptor.shader;this.state.blendMode=t.groupBlendMode;const r=i.resources.localUniforms.uniforms;r.uTransformMatrix=t.groupTransform,r.uRound=e._roundPixels|t._roundPixels,(0,o.V)(t.groupColorAlpha,r.uColor,0),this._adaptor.execute(this,t)}_rebuild(t){const e=!!this._graphicsBatchesHash[t.uid],s=this.renderer.graphicsContext.updateGpuContext(t.context);e&&this._removeBatchForRenderable(t.uid),s.isBatchable&&this._initBatchesForRenderable(t),t.batched=s.isBatchable}_addToBatcher(t,e){const s=this.renderer.renderPipes.batch,i=this._getBatchesForRenderable(t);for(let t=0;t<i.length;t++){const r=i[t];s.addToBatch(r,e)}}_getBatchesForRenderable(t){return this._graphicsBatchesHash[t.uid]||this._initBatchesForRenderable(t)}_initBatchesForRenderable(t){const e=t.context,s=this.renderer.graphicsContext.getGpuContext(e),i=this.renderer._roundPixels|t._roundPixels,r=s.batches.map((e=>{const s=a.Z.get(h.G);return e.copyTo(s),s.renderable=t,s.roundPixels=i,s}));return void 0===this._graphicsBatchesHash[t.uid]&&t.on("destroyed",(()=>{this.destroyRenderable(t)})),this._graphicsBatchesHash[t.uid]=r,r}_removeBatchForRenderable(t){this._graphicsBatchesHash[t].forEach((t=>{a.Z.return(t)})),this._graphicsBatchesHash[t]=null}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null;for(const t in this._graphicsBatchesHash)this._removeBatchForRenderable(t);this._graphicsBatchesHash=null}}l.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"graphics"},i.XO.add(l),i.XO.add(r.GH)},4389:(t,e,s)=>{"use strict";s.d(e,{G:()=>i});class i{constructor(){this.batcher=null,this.batch=null,this.applyTransform=!0,this.roundPixels=0}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}packIndex(t,e,s){const i=this.geometryData.indices;for(let r=0;r<this.indexSize;r++)t[e++]=i[r+this.indexOffset]+s-this.vertexOffset}packAttributes(t,e,s,i){const r=this.geometryData,n=this.renderable,a=r.vertices,o=r.uvs,h=2*this.vertexOffset,l=2*(this.vertexOffset+this.vertexSize),c=this.color,u=c>>16|65280&c|(255&c)<<16;if(this.applyTransform){const r=(d=u,p=n.groupColor,(16777215!==d&&p?16777215!==p&&d?((d>>16&255)*(p>>16&255)/255<<16)+((d>>8&255)*(p>>8&255)/255<<8)+(255&d)*(255&p)/255:d:p)+(this.alpha*n.groupAlpha*255<<24)),c=n.groupTransform,f=i<<16|65535&this.roundPixels,g=c.a,x=c.b,m=c.c,_=c.d,y=c.tx,b=c.ty;for(let i=h;i<l;i+=2){const n=a[i],h=a[i+1];t[s]=g*n+m*h+y,t[s+1]=x*n+_*h+b,t[s+2]=o[i],t[s+3]=o[i+1],e[s+4]=r,e[s+5]=f,s+=6}}else{const r=u+(255*this.alpha<<24);for(let n=h;n<l;n+=2)t[s]=a[n],t[s+1]=a[n+1],t[s+2]=o[n],t[s+3]=o[n+1],e[s+4]=r,e[s+5]=i<<16,s+=6}var d,p}get vertSize(){return this.vertexSize}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.vertexOffset=this.vertexOffset,t.vertexSize=this.vertexSize,t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData}reset(){this.applyTransform=!0}}},4835:(t,e,s)=>{"use strict";s.d(e,{T:()=>Q});var i=s(4486),r=s(2577),n=s(9313),a=s(5101),o=s(4492),h=s(133),l=s(4670),c=s(9636),u=s(268),d=s(8133),p=s(9252);class f{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new f(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let i=this.x-t,r=this.y-e;return i*=i,r*=r,i+r<=s}strokeContains(t,e,s){if(0===this.radius)return!1;const i=this.x-t,r=this.y-e,n=this.radius,a=s/2,o=Math.sqrt(i*i+r*r);return o<n+a&&o>n-a}getBounds(t){return(t=t||new p.M).x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class g{constructor(t=0,e=0,s=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=i}clone(){return new g(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return s*=s,i*=i,s+i<=1}strokeContains(t,e,s){const{halfWidth:i,halfHeight:r}=this;if(i<=0||r<=0)return!1;const n=s/2,a=i-n,o=r-n,h=i+n,l=r+n,c=t-this.x,u=e-this.y;return c*c/(a*a)+u*u/(o*o)>1&&c*c/(h*h)+u*u/(l*l)<=1}getBounds(){return new p.M(this.x-this.halfWidth,this.y-this.halfHeight,2*this.halfWidth,2*this.halfHeight)}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function x(t,e,s,i,r,n){const a=r-s,o=n-i,h=a*a+o*o;let l,c,u=-1;0!==h&&(u=((t-s)*a+(e-i)*o)/h),u<0?(l=s,c=i):u>1?(l=r,c=n):(l=s+u*a,c=i+u*o);const d=t-l,p=e-c;return d*d+p*p}class m{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let s=0,i=e.length;s<i;s++)t.push(e[s].x,e[s].y);e=t}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new m(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const i=this.points.length/2;for(let r=0,n=i-1;r<i;n=r++){const i=this.points[2*r],a=this.points[2*r+1],o=this.points[2*n],h=this.points[2*n+1];a>e!=h>e&&t<(e-a)/(h-a)*(o-i)+i&&(s=!s)}return s}strokeContains(t,e,s){const i=s/2,r=i*i,{points:n}=this,a=n.length-(this.closePath?0:2);for(let s=0;s<a;s+=2)if(x(t,e,n[s],n[s+1],n[(s+2)%n.length],n[(s+3)%n.length])<=r)return!0;return!1}getBounds(t){t=t||new p.M;const e=this.points;let s=1/0,i=-1/0,r=1/0,n=-1/0;for(let t=0,a=e.length;t<a;t+=2){const a=e[t],o=e[t+1];s=a<s?a:s,i=a>i?a:i,r=o<r?o:r,n=o>n?o:n}return t.x=s,t.width=i-s,t.y=r,t.height=n-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce(((t,e)=>`${t}, ${e}`),"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const _=(t,e,s,i,r,n)=>{const a=t-s,o=e-i,h=Math.sqrt(a*a+o*o);return h>=r-n&&h<=r+n};class y{constructor(t=0,e=0,s=0,i=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=i,this.radius=r}getBounds(t){return(t=t||new p.M).x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new y(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let i=t-(this.x+s),r=e-(this.y+s);const n=s*s;if(i*i+r*r<=n)return!0;if(i=t-(this.x+this.width-s),i*i+r*r<=n)return!0;if(r=e-(this.y+this.height-s),i*i+r*r<=n)return!0;if(i=t-(this.x+s),i*i+r*r<=n)return!0}return!1}strokeContains(t,e,s){const{x:i,y:r,width:n,height:a,radius:o}=this,h=s/2,l=i+o,c=r+o,u=i+n,d=r+a;return(t>=i-h&&t<=i+h||t>=u-h&&t<=u+h)&&e>=c&&e<=c+(a-2*o)||(e>=r-h&&e<=r+h||e>=d-h&&e<=d+h)&&t>=l&&t<=l+(n-2*o)||t<l&&e<c&&_(t,e,l,c,o,h)||t>u-o&&e<c&&_(t,e,u-o,c,o,h)||t>u-o&&e>d-o&&_(t,e,u-o,d-o,o,h)||t<l&&e>d-o&&_(t,e,l,d-o,o,h)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var b=s(3428);const S=8,v=1.1920929e-7,w=1,T=.01,M=0,P=0;function C(t,e,s,i,r,n,a,o,h,l){const c=Math.min(.99,Math.max(0,l??b.GH.defaultOptions.bezierSmoothness));let u=(w-c)/1;return u*=u,function(t,e,s,i,r,n,a,o,h,l){k(t,e,s,i,r,n,a,o,h,l,0),h.push(a,o)}(e,s,i,r,n,a,o,h,t,u),t}function k(t,e,s,i,r,n,a,o,h,l,c){if(c>S)return;const u=Math.PI,d=(t+s)/2,p=(e+i)/2,f=(s+r)/2,g=(i+n)/2,x=(r+a)/2,m=(n+o)/2,_=(d+f)/2,y=(p+g)/2,b=(f+x)/2,w=(g+m)/2,C=(_+b)/2,A=(y+w)/2;if(c>0){let c=a-t,d=o-e;const p=Math.abs((s-a)*d-(i-o)*c),f=Math.abs((r-a)*d-(n-o)*c);let g,x;if(p>v&&f>v){if((p+f)*(p+f)<=l*(c*c+d*d)){if(M<T)return void h.push(C,A);const l=Math.atan2(n-i,r-s);if(g=Math.abs(l-Math.atan2(i-e,s-t)),x=Math.abs(Math.atan2(o-n,a-r)-l),g>=u&&(g=2*u-g),x>=u&&(x=2*u-x),g+x<M)return void h.push(C,A);if(0!==P){if(g>P)return void h.push(s,i);if(x>P)return void h.push(r,n)}}}else if(p>v){if(p*p<=l*(c*c+d*d)){if(M<T)return void h.push(C,A);if(g=Math.abs(Math.atan2(n-i,r-s)-Math.atan2(i-e,s-t)),g>=u&&(g=2*u-g),g<M)return h.push(s,i),void h.push(r,n);if(0!==P&&g>P)return void h.push(s,i)}}else if(f>v){if(f*f<=l*(c*c+d*d)){if(M<T)return void h.push(C,A);if(g=Math.abs(Math.atan2(o-n,a-r)-Math.atan2(n-i,r-s)),g>=u&&(g=2*u-g),g<M)return h.push(s,i),void h.push(r,n);if(0!==P&&g>P)return void h.push(r,n)}}else if(c=C-(t+a)/2,d=A-(e+o)/2,c*c+d*d<=l)return void h.push(C,A)}k(t,e,d,p,_,y,C,A,h,l,c+1),k(C,A,b,w,x,m,a,o,h,l,c+1)}const A=8,B=1.1920929e-7,F=.01,R=0;function z(t,e,s,i,r,n,a,o){let h=(1-Math.min(.99,Math.max(0,o??b.GH.defaultOptions.bezierSmoothness)))/1;return h*=h,function(t,e,s,i,r,n,a,o){U(a,t,e,s,i,r,n,o,0),a.push(r,n)}(e,s,i,r,n,a,t,h),t}function U(t,e,s,i,r,n,a,o,h){if(h>A)return;const l=Math.PI,c=(e+i)/2,u=(s+r)/2,d=(i+n)/2,p=(r+a)/2,f=(c+d)/2,g=(u+p)/2;let x=n-e,m=a-s;const _=Math.abs((i-n)*m-(r-a)*x);if(_>B){if(_*_<=o*(x*x+m*m)){if(R<F)return void t.push(f,g);let o=Math.abs(Math.atan2(a-r,n-i)-Math.atan2(r-s,i-e));if(o>=l&&(o=2*l-o),o<R)return void t.push(f,g)}}else if(x=f-(e+n)/2,m=g-(s+a)/2,x*x+m*m<=o)return void t.push(f,g);U(t,e,s,c,u,f,g,o,h+1),U(t,f,g,d,p,n,a,o,h+1)}function W(t,e,s,i,r,n,a,o){let h=Math.abs(r-n);(!a&&r>n||a&&n>r)&&(h=2*Math.PI-h),o=o||Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)));let l=h/(o=Math.max(o,3)),c=r;l*=a?-1:1;for(let r=0;r<o+1;r++){const r=e+Math.cos(c)*i,n=s+Math.sin(c)*i;t.push(r,n),c+=l}}const I=2*Math.PI,H={centerX:0,centerY:0,ang1:0,ang2:0},G=({x:t,y:e},s,i,r,n,a,o,h)=>{const l=r*(t*=s)-n*(e*=i),c=n*t+r*e;return h.x=l+a,h.y=c+o,h};function O(t,e){const s=-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),i=1.5707963267948966===e?.551915024494:s,r=Math.cos(t),n=Math.sin(t),a=Math.cos(t+e),o=Math.sin(t+e);return[{x:r-n*i,y:n+r*i},{x:a+o*i,y:o-a*i},{x:a,y:o}]}const L=(t,e,s,i)=>{let r=t*s+e*i;return r>1&&(r=1),r<-1&&(r=-1),(t*i-e*s<0?-1:1)*Math.acos(r)};const D=new p.M;class E{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new c.c,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,i=s[s.length-2],r=s[s.length-1];return i===t&&r===e||s.push(t,e),this}arc(t,e,s,i,r,n){return this._ensurePoly(!1),W(this._currentPoly.points,t,e,s,i,r,n),this}arcTo(t,e,s,i,r){return this._ensurePoly(),function(t,e,s,i,r,n){const a=t[t.length-2],o=t[t.length-1]-s,h=a-e,l=r-s,c=i-e,u=Math.abs(o*c-h*l);if(u<1e-8||0===n)return void(t[t.length-2]===e&&t[t.length-1]===s||t.push(e,s));const d=o*o+h*h,p=l*l+c*c,f=o*l+h*c,g=n*Math.sqrt(d)/u,x=n*Math.sqrt(p)/u,m=g*f/d,_=x*f/p,y=g*c+x*h,b=g*l+x*o,S=h*(x+m),v=o*(x+m),w=c*(g+_),T=l*(g+_);W(t,y+e,b+s,n,Math.atan2(v-b,S-y),Math.atan2(T-b,w-y),h*l>c*o)}(this._currentPoly.points,t,e,s,i,r),this}arcToSvg(t,e,s,i,r,n,a){return function(t,e,s,i,r,n,a,o=0,h=0,l=0){if(0===n||0===a)return;const c=Math.sin(o*I/360),u=Math.cos(o*I/360),d=u*(e-i)/2+c*(s-r)/2,p=-c*(e-i)/2+u*(s-r)/2;if(0===d&&0===p)return;n=Math.abs(n),a=Math.abs(a);const f=Math.pow(d,2)/Math.pow(n,2)+Math.pow(p,2)/Math.pow(a,2);f>1&&(n*=Math.sqrt(f),a*=Math.sqrt(f)),((t,e,s,i,r,n,a,o,h,l,c,u,d)=>{const p=Math.pow(r,2),f=Math.pow(n,2),g=Math.pow(c,2),x=Math.pow(u,2);let m=p*f-p*x-f*g;m<0&&(m=0),m/=p*x+f*g,m=Math.sqrt(m)*(a===o?-1:1);const _=m*r/n*u,y=m*-n/r*c,b=l*_-h*y+(t+s)/2,S=h*_+l*y+(e+i)/2,v=(c-_)/r,w=(u-y)/n,T=(-c-_)/r,M=(-u-y)/n,P=L(1,0,v,w);let C=L(v,w,T,M);0===o&&C>0&&(C-=I),1===o&&C<0&&(C+=I),d.centerX=b,d.centerY=S,d.ang1=P,d.ang2=C})(e,s,i,r,n,a,h,l,c,u,d,p,H);let{ang1:g,ang2:x}=H;const{centerX:m,centerY:_}=H;let y=Math.abs(x)/(I/4);Math.abs(1-y)<1e-7&&(y=1);const b=Math.max(Math.ceil(y),1);x/=b;let S=t[t.length-2],v=t[t.length-1];const w={x:0,y:0};for(let e=0;e<b;e++){const e=O(g,x),{x:s,y:i}=G(e[0],n,a,u,c,m,_,w),{x:r,y:o}=G(e[1],n,a,u,c,m,_,w),{x:h,y:l}=G(e[2],n,a,u,c,m,_,w);C(t,S,v,s,i,r,o,h,l),S=h,v=l,g+=x}}(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,n,a,t,e,s,i,r),this}bezierCurveTo(t,e,s,i,r,n,a){this._ensurePoly();const o=this._currentPoly;return C(this._currentPoly.points,o.lastX,o.lastY,t,e,s,i,r,n,a),this}quadraticCurveTo(t,e,s,i,r){this._ensurePoly();const n=this._currentPoly;return z(this._currentPoly.points,n.lastX,n.lastY,t,e,s,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0)).transform(e);for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,i,r){return this.drawShape(new p.M(t,e,s,i),r),this}circle(t,e,s,i){return this.drawShape(new f(t,e,s),i),this}poly(t,e,s){const i=new m(t);return i.closePath=e,this.drawShape(i,s),this}regularPoly(t,e,s,i,r=0,n){i=Math.max(0|i,3);const a=-1*Math.PI/2+r,o=2*Math.PI/i,h=[];for(let r=0;r<i;r++){const i=r*o+a;h.push(t+s*Math.cos(i),e+s*Math.sin(i))}return this.poly(h,!0,n),this}roundPoly(t,e,s,i,r,n=0,a){if(i=Math.max(0|i,3),r<=0)return this.regularPoly(t,e,s,i,n);const o=s*Math.sin(Math.PI/i)-.001;r=Math.min(r,o);const h=-1*Math.PI/2+n,l=2*Math.PI/i,c=(i-2)*Math.PI/i/2;for(let n=0;n<i;n++){const i=n*l+h,o=t+s*Math.cos(i),u=e+s*Math.sin(i),d=i+Math.PI+c,p=i-Math.PI-c,f=o+r*Math.cos(d),g=u+r*Math.sin(d),x=o+r*Math.cos(p),m=u+r*Math.sin(p);0===n?this.moveTo(f,g):this.lineTo(f,g),this.quadraticCurveTo(o,u,x,m,a)}return this.closePath()}roundShape(t,e,s=!1,i){return t.length<3?this:(s?function(t,e,s,i){const r=(t,e)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),n=(t,e,s)=>({x:t.x+(e.x-t.x)*s,y:t.y+(e.y-t.y)*s}),a=e.length;for(let o=0;o<a;o++){const h=e[(o+1)%a],l=h.radius??s;if(l<=0){0===o?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y);continue}const c=e[o],u=e[(o+2)%a],d=r(c,h);let p;p=d<1e-4?h:n(h,c,Math.min(d/2,l)/d);const f=r(u,h);let g;g=f<1e-4?h:n(h,u,Math.min(f/2,l)/f),0===o?t.moveTo(p.x,p.y):t.lineTo(p.x,p.y),t.quadraticCurveTo(h.x,h.y,g.x,g.y,i)}}(this,t,e,i):function(t,e,s){const i=(t,e)=>{const s=e.x-t.x,i=e.y-t.y,r=Math.sqrt(s*s+i*i);return{len:r,nx:s/r,ny:i/r}},r=(e,s)=>{0===e?t.moveTo(s.x,s.y):t.lineTo(s.x,s.y)};let n=e[e.length-1];for(let a=0;a<e.length;a++){const o=e[a%e.length],h=o.radius??s;if(h<=0){r(a,o),n=o;continue}const l=e[(a+1)%e.length],c=i(o,n),u=i(o,l);if(c.len<1e-4||u.len<1e-4){r(a,o),n=o;continue}let d=Math.asin(c.nx*u.ny-c.ny*u.nx),p=1,f=!1;c.nx*u.nx-c.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,p=-1,f=!0):d>0&&(p=-1,f=!0);const g=d/2;let x,m=Math.abs(Math.cos(g)*h/Math.sin(g));m>Math.min(c.len/2,u.len/2)?(m=Math.min(c.len/2,u.len/2),x=Math.abs(m*Math.sin(g)/Math.cos(g))):x=h;const _=o.x+u.nx*m+-u.ny*x*p,y=o.y+u.ny*m+u.nx*x*p,b=Math.atan2(c.ny,c.nx)+Math.PI/2*p,S=Math.atan2(u.ny,u.nx)-Math.PI/2*p;0===a&&t.moveTo(_+Math.cos(b)*x,y+Math.sin(b)*x),t.arc(_,y,x,b,S,f),n=o}}(this,t,e),this.closePath())}filletRect(t,e,s,i,r){if(0===r)return this.rect(t,e,s,i);const n=Math.min(s,i)/2,a=Math.min(n,Math.max(-n,r)),o=t+s,h=e+i,l=a<0?-a:0,c=Math.abs(a);return this.moveTo(t,e+c).arcTo(t+l,e+l,t+c,e,c).lineTo(o-c,e).arcTo(o-l,e+l,o,e+c,c).lineTo(o,h-c).arcTo(o-l,h-l,t+s-c,h,c).lineTo(t+c,h).arcTo(t+l,h-l,t,h-c,c).closePath()}chamferRect(t,e,s,i,r,n){if(r<=0)return this.rect(t,e,s,i);const a=Math.min(r,Math.min(s,i)/2),o=t+s,h=e+i,l=[t+a,e,o-a,e,o,e+a,o,h-a,o-a,h,t+a,h,t,h-a,t,e+a];for(let t=l.length-1;t>=2;t-=2)l[t]===l[t-2]&&l[t-1]===l[t-3]&&l.splice(t-1,2);return this.poly(l,!0,n)}ellipse(t,e,s,i,r){return this.drawShape(new g(t,e,s,i),r),this}roundRect(t,e,s,i,r,n){return this.drawShape(new y(t,e,s,i,r),n),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new m,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new m,t)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let e=t.shape.x,s=t.shape.y;if(!t.transform.isIdentity()){const i=t.transform,r=e;e=i.a*e+i.c*s+i.tx,s=i.b*r+i.d*s+i.ty}this._currentPoly.points.push(e,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const i=e[s],r=i.shape.getBounds(D);i.transform?t.addRect(r,i.transform):t.addRect(r)}return t}}class V{constructor(t){this.instructions=[],this.uid=(0,h.L)("graphicsPath"),this._dirty=!0,"string"==typeof t?function(t,e){const s=d(t),i=[];let r=null,n=0,a=0;for(let t=0;t<s.length;t++){const o=s[t],h=o[0],l=o;switch(h){case"M":n=l[1],a=l[2],e.moveTo(n,a);break;case"m":n+=l[1],a+=l[2],e.moveTo(n,a);break;case"H":n=l[1],e.lineTo(n,a);break;case"h":n+=l[1],e.lineTo(n,a);break;case"V":a=l[1],e.lineTo(n,a);break;case"v":a+=l[1],e.lineTo(n,a);break;case"L":n=l[1],a=l[2],e.lineTo(n,a);break;case"l":n+=l[1],a+=l[2],e.lineTo(n,a);break;case"C":n=l[5],a=l[6],e.bezierCurveTo(l[1],l[2],l[3],l[4],n,a);break;case"c":e.bezierCurveTo(n+l[1],a+l[2],n+l[3],a+l[4],n+l[5],a+l[6]),n+=l[5],a+=l[6];break;case"S":n=l[3],a=l[4],e.bezierCurveToShort(l[1],l[2],n,a);break;case"s":e.bezierCurveToShort(n+l[1],a+l[2],n+l[3],a+l[4]),n+=l[3],a+=l[4];break;case"Q":n=l[3],a=l[4],e.quadraticCurveTo(l[1],l[2],n,a);break;case"q":e.quadraticCurveTo(n+l[1],a+l[2],n+l[3],a+l[4]),n+=l[3],a+=l[4];break;case"T":n=l[1],a=l[2],e.quadraticCurveToShort(n,a);break;case"t":n+=l[1],a+=l[2],e.quadraticCurveToShort(n,a);break;case"A":n=l[6],a=l[7],e.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,a);break;case"a":n+=l[6],a+=l[7],e.arcToSvg(l[1],l[2],l[3],l[4],l[5],n,a);break;case"Z":case"z":e.closePath(),i.length>0&&(r=i.pop(),r?(n=r.startX,a=r.startY):(n=0,a=0)),r=null;break;default:(0,u.R)(`Unknown SVG path command: ${h}`)}"Z"!==h&&"z"!==h&&null===r&&(r={startX:n,startY:a},i.push(r))}}(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new E(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,i,r){const n=this.instructions[this.instructions.length-1],o=this.getLastPoint(a.b.shared);let h=0,l=0;if(n&&"bezierCurveTo"===n.action){h=n.data[2],l=n.data[3];const t=o.x,e=o.y;h=t+(t-h),l=e+(e-l)}else h=o.x,l=o.y;return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,s,i,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const i=this.instructions[this.instructions.length-1],r=this.getLastPoint(a.b.shared);let n=0,o=0;if(i&&"quadraticCurveTo"===i.action){n=i.data[0],o=i.data[1];const t=r.x,e=r.y;n=t+(t-n),o=e+(e-o)}else n=r.x,o=r.y;return this.instructions.push({action:"quadraticCurveTo",data:[n,o,t,e,s]}),this._dirty=!0,this}rect(t,e,s,i,r){return this.instructions.push({action:"rect",data:[t,e,s,i,r]}),this._dirty=!0,this}circle(t,e,s,i){return this.instructions.push({action:"circle",data:[t,e,s,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,i,r,n,a){r=r||i/2;const o=-1*Math.PI/2+n,h=2*s,l=2*Math.PI/h,c=[];for(let s=0;s<h;s++){const n=s%2?r:i,a=s*l+o;c.push(t+n*Math.cos(a),e+n*Math.sin(a))}return this.poly(c,!0,a),this}clone(t=!1){const e=new V;if(t)for(let t=0;t<this.instructions.length;t++){const s=this.instructions[t];e.instructions.push({action:s.action,data:s.data.slice()})}else e.instructions=this.instructions.slice();return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,i=t.c,r=t.d,n=t.tx,a=t.ty;let o=0,h=0,l=0,c=0,d=0,p=0,f=0,g=0;for(let x=0;x<this.instructions.length;x++){const m=this.instructions[x],_=m.data;switch(m.action){case"moveTo":case"lineTo":o=_[0],h=_[1],_[0]=e*o+i*h+n,_[1]=s*o+r*h+a;break;case"bezierCurveTo":l=_[0],c=_[1],d=_[2],p=_[3],o=_[4],h=_[5],_[0]=e*l+i*c+n,_[1]=s*l+r*c+a,_[2]=e*d+i*p+n,_[3]=s*d+r*p+a,_[4]=e*o+i*h+n,_[5]=s*o+r*h+a;break;case"quadraticCurveTo":l=_[0],c=_[1],o=_[2],h=_[3],_[0]=e*l+i*c+n,_[1]=s*l+r*c+a,_[2]=e*o+i*h+n,_[3]=s*o+r*h+a;break;case"arcToSvg":o=_[5],h=_[6],f=_[0],g=_[1],_[0]=e*f+i*g,_[1]=s*f+r*g,_[5]=e*o+i*h+n,_[6]=s*o+r*h+a;break;case"circle":_[4]=$(_[3],t);break;case"rect":_[4]=$(_[4],t);break;case"ellipse":_[8]=$(_[8],t);break;case"roundRect":_[5]=$(_[5],t);break;case"addPath":_[0].transform(t);break;case"poly":_[2]=$(_[2],t);break;default:(0,u.R)("unknown transform action",m.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;"closePath"===s.action;){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t)}return t}}function $(t,e){return t?t.prepend(e):e.clone()}function X(t,e){if("string"==typeof t){const e=document.createElement("div");e.innerHTML=t.trim(),t=e.querySelector("svg")}return N(t,{context:e,path:new V},null,null),e}function N(t,e,s,i){const n=t.children,{fillStyle:a,strokeStyle:o}=function(t){const e=t.getAttribute("style"),s={},i={};let n=!1,a=!1;if(e){const t=e.split(";");for(let e=0;e<t.length;e++){const o=t[e],[h,l]=o.split(":");switch(h){case"stroke":"none"!==l&&(s.color=r.Q.shared.setValue(l).toNumber(),a=!0);break;case"stroke-width":s.width=Number(l);break;case"fill":"none"!==l&&(n=!0,i.color=r.Q.shared.setValue(l).toNumber());break;case"fill-opacity":i.alpha=Number(l);break;case"stroke-opacity":s.alpha=Number(l);break;case"opacity":i.alpha=Number(l),s.alpha=Number(l)}}}else{const e=t.getAttribute("stroke");e&&"none"!==e&&(a=!0,s.color=r.Q.shared.setValue(e).toNumber(),s.width=q(t,"stroke-width",1));const o=t.getAttribute("fill");o&&"none"!==o&&(n=!0,i.color=r.Q.shared.setValue(o).toNumber())}return{strokeStyle:a?s:null,fillStyle:n?i:null}}(t);let h,l,c,u,d,p,f,g,x,m,_,y,b,S,v,w,T;switch(a&&s?s={...s,...a}:a&&(s=a),o&&i?i={...i,...o}:o&&(i=o),e.context.fillStyle=s,e.context.strokeStyle=i,t.nodeName.toLowerCase()){case"path":S=t.getAttribute("d"),v=new V(S),e.context.path(v),s&&e.context.fill(),i&&e.context.stroke();break;case"circle":f=q(t,"cx",0),g=q(t,"cy",0),x=q(t,"r",0),e.context.ellipse(f,g,x,x),s&&e.context.fill(),i&&e.context.stroke();break;case"rect":h=q(t,"x",0),l=q(t,"y",0),w=q(t,"width",0),T=q(t,"height",0),m=q(t,"rx",0),_=q(t,"ry",0),m||_?e.context.roundRect(h,l,w,T,m||_):e.context.rect(h,l,w,T),s&&e.context.fill(),i&&e.context.stroke();break;case"ellipse":f=q(t,"cx",0),g=q(t,"cy",0),m=q(t,"rx",0),_=q(t,"ry",0),e.context.beginPath(),e.context.ellipse(f,g,m,_),s&&e.context.fill(),i&&e.context.stroke();break;case"line":c=q(t,"x1",0),u=q(t,"y1",0),d=q(t,"x2",0),p=q(t,"y2",0),e.context.beginPath(),e.context.moveTo(c,u),e.context.lineTo(d,p),i&&e.context.stroke();break;case"polygon":b=t.getAttribute("points"),y=b.match(/\d+/g).map((t=>parseInt(t,10))),e.context.poly(y,!0),s&&e.context.fill(),i&&e.context.stroke();break;case"polyline":b=t.getAttribute("points"),y=b.match(/\d+/g).map((t=>parseInt(t,10))),e.context.poly(y,!1),i&&e.context.stroke();break;case"g":case"svg":break;default:console.info(`[SVG parser] <${t.nodeName}> elements unsupported`)}for(let t=0;t<n.length;t++)N(n[t],e,s,i)}function q(t,e,s){const i=t.getAttribute(e);return i?Number(i):s}var Y=s(990);const j=new a.b,K=new n.u,Z=class t extends i.A{constructor(){super(...arguments),this.uid=(0,h.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new V,this._transform=new n.u,this._fillStyle={...t.defaultFillStyle},this._strokeStyle={...t.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new c.c,this._boundsDirty=!0}clone(){const e=new t;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=(0,Y.M)(e,t.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=(0,Y.M)(e,t.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=(0,Y.M)(e,t.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=(0,Y.M)(e,t.defaultStrokeStyle),this}texture(t,e,s,i,n,a){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:i||0,dw:n||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?r.Q.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new V,this}fill(e,s){let i;const r=this.instructions[this.instructions.length-1];return i=0===this._tick&&r&&"stroke"===r.action?r.data.path:this._activePath.clone(),i?(null!=e&&(void 0!==s&&"number"==typeof e&&((0,l.t)(l.l,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:s}),this._fillStyle=(0,Y.M)(e,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(a.b.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(e){let s;const i=this.instructions[this.instructions.length-1];return s=0===this._tick&&i&&"fill"===i.action?i.data.path:this._activePath.clone(),s?(null!=e&&(this._strokeStyle=(0,Y.M)(e,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&("stroke"===e.action||"fill"===e.action)){if(!e.data.hole){e.data.hole=s;break}e.data.hole.addPath(s)}}return this._initNextPathLocation(),this}arc(t,e,s,i,r,n){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,s,i,r,n),this}arcTo(t,e,s,i,r){this._tick++;const n=this._transform;return this._activePath.arcTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty,n.a*s+n.c*i+n.tx,n.b*s+n.d*i+n.ty,r),this}arcToSvg(t,e,s,i,r,n,a){this._tick++;const o=this._transform;return this._activePath.arcToSvg(t,e,s,i,r,o.a*n+o.c*a+o.tx,o.b*n+o.d*a+o.ty),this}bezierCurveTo(t,e,s,i,r,n,a){this._tick++;const o=this._transform;return this._activePath.bezierCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*s+o.c*i+o.tx,o.b*s+o.d*i+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,s,i){return this._tick++,this._activePath.ellipse(t,e,s,i,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,i=this._activePath.instructions,r=s.a*t+s.c*e+s.tx,n=s.b*t+s.d*e+s.ty;return 1===i.length&&"moveTo"===i[0].action?(i[0].data[0]=r,i[0].data[1]=n,this):(this._activePath.moveTo(r,n),this)}quadraticCurveTo(t,e,s,i,r){this._tick++;const n=this._transform;return this._activePath.quadraticCurveTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty,n.a*s+n.c*i+n.tx,n.b*s+n.d*i+n.ty,r),this}rect(t,e,s,i){return this._tick++,this._activePath.rect(t,e,s,i,this._transform.clone()),this}roundRect(t,e,s,i,r){return this._tick++,this._activePath.roundRect(t,e,s,i,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,i,r=0,n){return this._tick++,this._activePath.regularPoly(t,e,s,i,r,n),this}roundPoly(t,e,s,i,r,n){return this._tick++,this._activePath.roundPoly(t,e,s,i,r,n),this}roundShape(t,e,s,i){return this._tick++,this._activePath.roundShape(t,e,s,i),this}filletRect(t,e,s,i,r){return this._tick++,this._activePath.filletRect(t,e,s,i,r),this}chamferRect(t,e,s,i,r,n){return this._tick++,this._activePath.chamferRect(t,e,s,i,r,n),this}star(t,e,s,i,r=0,n=0){return this._tick++,this._activePath.star(t,e,s,i,r,n,this._transform.clone()),this}svg(t){return this._tick++,X(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,i,r,a){return t instanceof n.u?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,i,r,a),this)}transform(t,e,s,i,r,a){return t instanceof n.u?(this._transform.append(t),this):(K.set(t,e,s,i,r,a),this._transform.append(K),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],i=s.action;if("fill"===i){const e=s.data;t.addBounds(e.path.bounds)}else if("texture"===i){const e=s.data;t.addFrame(e.dx,e.dy,e.dx+e.dw,e.dy+e.dh,e.transform)}if("stroke"===i){const e=s.data,i=e.style.width/2,r=e.path.bounds;t.addFrame(r.minX-i,r.minY-i,r.maxX+i,r.maxY+i)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let i=0;i<e.length;i++){const r=e[i],n=r.data,a=n.path;if(!r.action||!a)continue;const o=n.style,h=a.shapePath.shapePrimitives;for(let e=0;e<h.length;e++){const i=h[e].shape;if(!o||!i)continue;const a=h[e].transform,l=a?a.applyInverse(t,j):t;s="fill"===r.action?i.contains(l.x,l.y):i.strokeContains(l.x,l.y,o.width);const c=n.hole;if(c){const t=c.shapePath?.shapePrimitives;if(t)for(let e=0;e<t.length;e++)t[e].shape.contains(l.x,l.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(e),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(e)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Z.defaultFillStyle={color:16777215,alpha:1,texture:o.g.WHITE,matrix:null,fill:null},Z.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:o.g.WHITE,matrix:null,fill:null};let Q=Z},3428:(t,e,s)=>{"use strict";s.d(e,{GH:()=>k});var i=s(8507),r=s(8634),n=s(341),a=s(1478),o=s(848),h=s(8218),l=s(9252);function c(t,e,s,i,r){const n=e.a,a=e.b,o=e.c,h=e.d,l=e.tx,c=e.ty;s=s||0,i=i||2,r=r||t.length/i-s;let u=s*i;for(let e=0;e<r;e++){const e=t[u],s=t[u+1];t[u]=n*e+o*s+l,t[u+1]=a*e+h*s+c,u+=i}}var u=s(4492),d=s(4389);const p={build(t,e){let s,i,r,n,a,o;if("circle"===t.type){const e=t;s=e.x,i=e.y,a=o=e.radius,r=n=0}else if("ellipse"===t.type){const e=t;s=e.x,i=e.y,a=e.halfWidth,o=e.halfHeight,r=n=0}else{const e=t,h=e.width/2,l=e.height/2;s=e.x+h,i=e.y+l,a=o=Math.max(0,Math.min(e.radius,Math.min(h,l))),r=h-a,n=l-o}if(!(a>=0&&o>=0&&r>=0&&n>=0))return e;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=8*h+(r?4:0)+(n?4:0);if(0===l)return e;if(0===h)return e[0]=e[6]=s+r,e[1]=e[3]=i+n,e[2]=e[4]=s-r,e[5]=e[7]=i-n,e;let c=0,u=4*h+(r?2:0)+2,d=u,p=l,f=r+a,g=n,x=s+f,m=s-f,_=i+g;if(e[c++]=x,e[c++]=_,e[--u]=_,e[--u]=m,n){const t=i-g;e[d++]=m,e[d++]=t,e[--p]=t,e[--p]=x}for(let t=1;t<h;t++){const l=Math.PI/2*(t/h),f=r+Math.cos(l)*a,g=n+Math.sin(l)*o,x=s+f,m=s-f,_=i+g,y=i-g;e[c++]=x,e[c++]=_,e[--u]=_,e[--u]=m,e[d++]=m,e[d++]=y,e[--p]=y,e[--p]=x}f=r,g=n+o,x=s+f,m=s-f,_=i+g;const y=i-g;return e[c++]=x,e[c++]=_,e[--p]=y,e[--p]=x,r&&(e[c++]=m,e[c++]=_,e[--p]=y,e[--p]=m),e},triangulate(t,e,s,i,r,n){if(0===t.length)return;let a=0,o=0;for(let e=0;e<t.length;e+=2)a+=t[e],o+=t[e+1];a/=t.length/2,o/=t.length/2;let h=i;e[h*s]=a,e[h*s+1]=o;const l=h++;for(let i=0;i<t.length;i+=2)e[h*s]=t[i],e[h*s+1]=t[i+1],i>0&&(r[n++]=h,r[n++]=l,r[n++]=h-1),h++;r[n++]=l+1,r[n++]=l,r[n++]=h-1}};var f=s(5101);function g(t,e,s,i,r,n,a,o){let h,l;a?(h=i,l=-s):(h=-i,l=s);const c=t-s*r+h,u=e-i*r+l,d=t+s*n+h,p=e+i*n+l;return o.push(c,u),o.push(d,p),2}function x(t,e,s,i,r,n,a,o){const h=s-t,l=i-e;let c=Math.atan2(h,l),u=Math.atan2(r-t,n-e);o&&c<u?c+=2*Math.PI:!o&&c>u&&(u+=2*Math.PI);let d=c;const p=u-c,f=Math.abs(p),g=Math.sqrt(h*h+l*l),x=1+(15*f*Math.sqrt(g)/Math.PI|0),m=p/x;if(d+=m,o){a.push(t,e),a.push(s,i);for(let s=1,i=d;s<x;s++,i+=m)a.push(t,e),a.push(t+Math.sin(i)*g,e+Math.cos(i)*g);a.push(t,e),a.push(r,n)}else{a.push(s,i),a.push(t,e);for(let s=1,i=d;s<x;s++,i+=m)a.push(t+Math.sin(i)*g,e+Math.cos(i)*g),a.push(t,e);a.push(r,n),a.push(t,e)}return 2*x}var m=s(6570);function _(t,e,s,i,r,n,a){const o=m(t,e,2);if(!o)return;for(let t=0;t<o.length;t+=3)n[a++]=o[t]+r,n[a++]=o[t+1]+r,n[a++]=o[t+2]+r;let h=r*i;for(let e=0;e<t.length;e+=2)s[h]=t[e],s[h+1]=t[e+1],h+=i}const y=[],b={build(t,e){for(let s=0;s<t.points.length;s++)e[s]=t.points[s];return e},triangulate(t,e,s,i,r,n){_(t,y,e,s,i,r,n)}},S={rectangle:{build(t,e){const s=t,i=s.x,r=s.y,n=s.width,a=s.height;return n>=0&&a>=0?(e[0]=i,e[1]=r,e[2]=i+n,e[3]=r,e[4]=i+n,e[5]=r+a,e[6]=i,e[7]=r+a,e):e},triangulate(t,e,s,i,r,n){let a=0;e[(i*=s)+a]=t[0],e[i+a+1]=t[1],a+=s,e[i+a]=t[2],e[i+a+1]=t[3],a+=s,e[i+a]=t[6],e[i+a+1]=t[7],a+=s,e[i+a]=t[4],e[i+a+1]=t[5],a+=s;const o=i/s;r[n++]=o,r[n++]=o+1,r[n++]=o+2,r[n++]=o+1,r[n++]=o+3,r[n++]=o+2}},polygon:b,triangle:{build:(t,e)=>(e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,e),triangulate(t,e,s,i,r,n){let a=0;e[(i*=s)+a]=t[0],e[i+a+1]=t[1],a+=s,e[i+a]=t[2],e[i+a+1]=t[3],a+=s,e[i+a]=t[4],e[i+a+1]=t[5];const o=i/s;r[n++]=o,r[n++]=o+1,r[n++]=o+2}},circle:p,ellipse:p,roundedRectangle:p},v=new l.M;function w(t,e,s){const{vertices:i,uvs:r,indices:n}=s,a=n.length,o=i.length/2,l=[],u=S.rectangle,p=v,f=t.image;p.x=t.dx,p.y=t.dy,p.width=t.dw,p.height=t.dh;const g=t.transform;u.build(p,l),g&&c(l,g),u.triangulate(l,i,2,o,n,a);const x=f.uvs;r.push(x.x0,x.y0,x.x1,x.y1,x.x3,x.y3,x.x2,x.y2);const m=h.Z.get(d.G);m.indexOffset=a,m.indexSize=n.length-a,m.vertexOffset=o,m.vertexSize=i.length/2-o,m.color=t.style,m.alpha=t.alpha,m.texture=f,m.geometryData=s,e.push(m)}function T(t,e,s,i,r,n){const{vertices:a,uvs:o,indices:l}=n,p=t.shapePrimitives.length-1;t.shapePrimitives.forEach((({shape:t,transform:m},y)=>{const b=l.length,v=a.length/2,w=[],T=S[t.type];if(T.build(t,w),m&&c(w,m),i){const s=t.closePath??!0;!function(t,e,s,i,r,n,a,o,h){const l=1e-4;if(0===t.length)return;const c=e;let u=c.alignment;if(.5!==e.alignment){let e=function(t){const e=t.length;if(e<6)return 1;let s=0;for(let i=0,r=t[e-2],n=t[e-1];i<e;i+=2){const e=t[i],a=t[i+1];s+=(e-r)*(a+n),r=e,n=a}return s<0?-1:1}(t);u=(u-.5)*e+.5}const d=new f.b(t[0],t[1]),p=new f.b(t[t.length-2],t[t.length-1]),m=i,_=Math.abs(d.x-p.x)<l&&Math.abs(d.y-p.y)<l;if(m){t=t.slice(),_&&(t.pop(),t.pop(),p.set(t[t.length-2],t[t.length-1]));const e=.5*(d.x+p.x),s=.5*(p.y+d.y);t.unshift(e,s),t.push(e,s)}const y=r,b=t.length/2;let S=t.length;const v=y.length/2,w=c.width/2,T=w*w,M=c.miterLimit*c.miterLimit;let P=t[0],C=t[1],k=t[2],A=t[3],B=0,F=0,R=-(C-A),z=P-k,U=0,W=0,I=Math.sqrt(R*R+z*z);R/=I,z/=I,R*=w,z*=w;const H=2*(1-u),G=2*u;m||("round"===c.cap?S+=x(P-R*(H-G)*.5,C-z*(H-G)*.5,P-R*H,C-z*H,P+R*G,C+z*G,y,!0)+2:"square"===c.cap&&(S+=g(P,C,R,z,H,G,!0,y))),y.push(P-R*H,C-z*H),y.push(P+R*G,C+z*G);for(let e=1;e<b-1;++e){P=t[2*(e-1)],C=t[2*(e-1)+1],k=t[2*e],A=t[2*e+1],B=t[2*(e+1)],F=t[2*(e+1)+1],R=-(C-A),z=P-k,I=Math.sqrt(R*R+z*z),R/=I,z/=I,R*=w,z*=w,U=-(A-F),W=k-B,I=Math.sqrt(U*U+W*W),U/=I,W/=I,U*=w,W*=w;const s=k-P,i=C-A,r=k-B,n=F-A,a=s*r+i*n,o=i*r-n*s,h=o<0;if(Math.abs(o)<.001*Math.abs(a)){y.push(k-R*H,A-z*H),y.push(k+R*G,A+z*G),a>=0&&("round"===c.join?S+=x(k,A,k-R*H,A-z*H,k-U*H,A-W*H,y,!1)+4:S+=2,y.push(k-U*G,A-W*G),y.push(k+U*H,A+W*H));continue}const l=(-R+P)*(-z+A)-(-R+k)*(-z+C),u=(-U+B)*(-W+A)-(-U+k)*(-W+F),d=(s*u-r*l)/o,p=(n*l-i*u)/o,f=(d-k)*(d-k)+(p-A)*(p-A),g=k+(d-k)*H,m=A+(p-A)*H,_=k-(d-k)*G,b=A-(p-A)*G,v=h?H:G;f<=Math.min(s*s+i*i,r*r+n*n)+v*v*T?"bevel"===c.join||f/T>M?(h?(y.push(g,m),y.push(k+R*G,A+z*G),y.push(g,m),y.push(k+U*G,A+W*G)):(y.push(k-R*H,A-z*H),y.push(_,b),y.push(k-U*H,A-W*H),y.push(_,b)),S+=2):"round"===c.join?h?(y.push(g,m),y.push(k+R*G,A+z*G),S+=x(k,A,k+R*G,A+z*G,k+U*G,A+W*G,y,!0)+4,y.push(g,m),y.push(k+U*G,A+W*G)):(y.push(k-R*H,A-z*H),y.push(_,b),S+=x(k,A,k-R*H,A-z*H,k-U*H,A-W*H,y,!1)+4,y.push(k-U*H,A-W*H),y.push(_,b)):(y.push(g,m),y.push(_,b)):(y.push(k-R*H,A-z*H),y.push(k+R*G,A+z*G),"round"===c.join?S+=h?x(k,A,k+R*G,A+z*G,k+U*G,A+W*G,y,!0)+2:x(k,A,k-R*H,A-z*H,k-U*H,A-W*H,y,!1)+2:"miter"===c.join&&f/T<=M&&(h?(y.push(_,b),y.push(_,b)):(y.push(g,m),y.push(g,m)),S+=2),y.push(k-U*H,A-W*H),y.push(k+U*G,A+W*G),S+=2)}P=t[2*(b-2)],C=t[2*(b-2)+1],k=t[2*(b-1)],A=t[2*(b-1)+1],R=-(C-A),z=P-k,I=Math.sqrt(R*R+z*z),R/=I,z/=I,R*=w,z*=w,y.push(k-R*H,A-z*H),y.push(k+R*G,A+z*G),m||("round"===c.cap?S+=x(k-R*(H-G)*.5,A-z*(H-G)*.5,k-R*H,A-z*H,k+R*G,A+z*G,y,!1)+2:"square"===c.cap&&(S+=g(k,A,R,z,H,G,!1,y)));for(let t=v;t<S+v-2;++t)P=y[2*t],C=y[2*t+1],k=y[2*(t+1)],A=y[2*(t+1)+1],B=y[2*(t+2)],F=y[2*(t+2)+1],Math.abs(P*(A-F)+k*(F-C)+B*(C-A))<1e-8||o.push(t,t+1,t+2)}(w,e,0,s,a,0,0,l)}else if(s&&p===y){0!==p&&console.warn("[Pixi Graphics] only the last shape have be cut out");const t=[],e=w.slice(),i=function(t){if(!t)return[];const e=t.shapePrimitives,s=[];for(let t=0;t<e.length;t++){const i=e[t].shape,r=[];S[i.type].build(i,r),s.push(r)}return s}(s.shapePath);i.forEach((s=>{t.push(e.length/2),e.push(...s)})),_(e,t,a,2,v,l,b)}else T.triangulate(w,a,2,v,l,b);const M=o.length/2,P=e.texture;if(P!==u.g.WHITE){const t=e.matrix;m&&t.append(m.clone().invert()),function(t,e,s,i,r,n,a,o=null){let h=0;s*=e,r*=n;const l=o.a,c=o.b,u=o.c,d=o.d,p=o.tx,f=o.ty;for(;h<a;){const a=t[s],o=t[s+1];i[r]=l*a+u*o+p,i[r+1]=c*a+d*o+f,r+=n,s+=e,h++}}(a,2,v,o,M,2,a.length/2-v,t)}else!function(t,e,s,i){let r=0;for(e*=2;r<i;)t[e]=0,t[e+1]=0,e+=2,r++}(o,M,0,a.length/2-v);const C=h.Z.get(d.G);C.indexOffset=b,C.indexSize=l.length-b,C.vertexOffset=v,C.vertexSize=a.length/2-v,C.color=e.color,C.alpha=e.alpha,C.texture=P,C.geometryData=n,r.push(C)}))}class M{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class P{constructor(){this.geometry=new r.J,this.instructions=new o.L}init(){this.instructions.reset()}}const C=class t{constructor(){this._activeBatchers=[],this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null)}init(e){t.defaultOptions.bezierSmoothness=e?.bezierSmoothness??t.defaultOptions.bezierSmoothness}prerender(){this._returnActiveBatchers()}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),function(t,e){const{geometryData:s,batches:i}=e;i.length=0,s.indices.length=0,s.vertices.length=0,s.uvs.length=0;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];if("texture"===r.action)w(r.data,i,s);else if("fill"===r.action||"stroke"===r.action){const t="stroke"===r.action,e=r.data.path.shapePath,n=r.data.style,a=r.data.hole;t&&a&&T(a.shapePath,n,null,!0,i,s),T(e,n,a,t,i,s)}}}(t,e);const s=t.batchMode;t.customShader||"no-batch"===s?e.isBatchable=!1:"auto"===s&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_returnActiveBatchers(){for(let t=0;t<this._activeBatchers.length;t++)h.Z.return(this._activeBatchers[t]);this._activeBatchers.length=0}_initContextRenderData(t){const e=h.Z.get(P),{batches:s,geometryData:i}=this._gpuContextHash[t.uid],r=i.vertices.length,o=i.indices.length;for(let t=0;t<s.length;t++)s[t].applyTransform=!1;const l=h.Z.get(a.i);this._activeBatchers.push(l),l.ensureAttributeBuffer(r),l.ensureIndexBuffer(o),l.begin();for(let t=0;t<s.length;t++){const e=s[t];l.add(e)}l.finish(e.instructions);const c=e.geometry;c.indexBuffer.setDataWithSize(l.indexBuffer,l.indexSize,!0),c.buffers[0].setDataWithSize(l.attributeBuffer.float32View,l.attributeSize,!0);const u=l.batches;for(let t=0;t<u.length;t++){const e=u[t];e.bindGroup=(0,n.w)(e.textures.textures,e.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new M;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(h.Z.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach((t=>{h.Z.return(t)}))}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};C.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem,i.Ag.CanvasSystem],name:"graphicsContext"},C.defaultOptions={bezierSmoothness:.5};let k=C},7276:(t,e,s)=>{"use strict";s.d(e,{_:()=>c});var i=s(2577),r=s(1761),n=s(9313),a=s(8293),o=s(4492),h=s(133);const l=class t{constructor(t,e,s,i){this.uid=(0,h.L)("fillGradient"),this.type="linear",this.gradientStops=[],this.x0=t,this.y0=e,this.x1=s,this.y1=i}addColorStop(t,e){return this.gradientStops.push({offset:t,color:i.Q.shared.setValue(e).toHex()}),this}buildLinearGradient(){const e=t.defaultTextureSize,{gradientStops:s}=this,i=r.e.get().createCanvas();i.width=e,i.height=e;const h=i.getContext("2d"),l=h.createLinearGradient(0,0,t.defaultTextureSize,1);for(let t=0;t<s.length;t++){const e=s[t];l.addColorStop(e.offset,e.color)}h.fillStyle=l,h.fillRect(0,0,e,e),this.texture=new o.g({source:new a.b({resource:i,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:c,y0:u,x1:d,y1:p}=this,f=new n.u,g=d-c,x=p-u,m=Math.sqrt(g*g+x*x),_=Math.atan2(x,g);f.translate(-c,-u),f.scale(1/e,1/e),f.rotate(-_),f.scale(256/m,1),this.transform=f}};l.defaultTextureSize=256;let c=l},2806:(t,e,s)=>{"use strict";s.d(e,{m:()=>a});var i=s(9313),r=s(133);const n={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class a{constructor(t,e){this.uid=(0,r.L)("fillPattern"),this.transform=new i.u,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=n[e].addressModeU,t.source.style.addressModeV=n[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height)}}},990:(t,e,s)=>{"use strict";s.d(e,{M:()=>h});var i=s(2577),r=s(9313),n=s(4492),a=s(7276),o=s(2806);function h(t,e){if(null==t)return null;let s,h;if(t?.fill?(h=t.fill,s={...e,...t}):(h=t,s=e),i.Q.isColorLike(h)){const t=i.Q.shared.setValue(h??0);return{...s,color:t.toNumber(),alpha:1===t.alpha?s.alpha:t.alpha,texture:n.g.WHITE}}if(h instanceof o.m){const t=h;return{...s,color:16777215,texture:t.texture,matrix:t.transform,fill:s.fill??null}}if(h instanceof a._){const t=h;return t.buildLinearGradient(),{...s,color:16777215,texture:t.texture,matrix:t.transform}}const l={...e,...t};if(l.texture){if(l.texture!==n.g.WHITE){const t=l.matrix?.invert()||new r.u;t.scale(1/l.texture.frame.width,1/l.texture.frame.height),l.matrix=t}const t=l.texture.source.style;"clamp-to-edge"===t.addressMode&&(t.addressMode="repeat")}const c=i.Q.shared.setValue(l.color);return l.alpha*=c.alpha,l.color=c.toNumber(),l.matrix=l.matrix?l.matrix.clone():null,l}},5285:(t,e,s)=>{"use strict";var i=s(8507),r=s(9313),n=s(3513),a=s(5811),o=s(8218),h=s(2760),l=s(8734);class c{constructor(t,e){this.localUniforms=new a.k({uTransformMatrix:{value:new r.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new n.T({0:this.localUniforms}),this._meshDataHash=Object.create(null),this._gpuBatchableMeshHash=Object.create(null),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){const e=this._getMeshData(t),s=e.batched,i=t.batched;if(e.batched=i,s!==i)return!0;if(i){const s=t._geometry;if(s.indices.length!==e.indexSize||s.positions.length!==e.vertexSize)return e.indexSize=s.indices.length,e.vertexSize=s.positions.length,!0;const i=this._getBatchableMesh(t),r=t.texture;if(i.texture._source!==r._source&&i.texture._source!==r._source)return!i.batcher.checkAndUpdateTexture(i,r)}return!1}addRenderable(t,e){const s=this.renderer.renderPipes.batch,{batched:i}=this._getMeshData(t);if(i){const e=this._getBatchableMesh(t);e.texture=t._texture,e.geometry=t._geometry,s.addToBatch(e)}else s.break(e),e.add({renderPipeId:"mesh",mesh:t})}updateRenderable(t){if(t.batched){const e=this._gpuBatchableMeshHash[t.uid];e.texture=t._texture,e.geometry=t._geometry,e.batcher.updateElement(e)}}destroyRenderable(t){this._meshDataHash[t.uid]=null;const e=this._gpuBatchableMeshHash[t.uid];e&&(o.Z.return(e),this._gpuBatchableMeshHash[t.uid]=null)}execute({mesh:t}){if(!t.isRenderable)return;t.state.blendMode=t.groupBlendMode;const e=this.localUniforms;e.uniforms.uTransformMatrix=t.groupTransform,e.uniforms.uRound=this.renderer._roundPixels|t._roundPixels,e.update(),(0,h.V)(t.groupColorAlpha,e.uniforms.uColor,0),this._adaptor.execute(this,t)}_getMeshData(t){return this._meshDataHash[t.uid]||this._initMeshData(t)}_initMeshData(t){return this._meshDataHash[t.uid]={batched:t.batched,indexSize:t._geometry.indices?.length,vertexSize:t._geometry.positions?.length},t.on("destroyed",(()=>{this.destroyRenderable(t)})),this._meshDataHash[t.uid]}_getBatchableMesh(t){return this._gpuBatchableMeshHash[t.uid]||this._initBatchableMesh(t)}_initBatchableMesh(t){const e=o.Z.get(l.U);return e.mesh=t,e.texture=t._texture,e.roundPixels=this.renderer._roundPixels|t._roundPixels,this._gpuBatchableMeshHash[t.uid]=e,e.mesh=t,e}destroy(){for(const t in this._gpuBatchableMeshHash)this._gpuBatchableMeshHash[t]&&o.Z.return(this._gpuBatchableMeshHash[t]);this._gpuBatchableMeshHash=null,this._meshDataHash=null,this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}c.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"mesh"},i.XO.add(c)},8734:(t,e,s)=>{"use strict";s.d(e,{U:()=>i});class i{constructor(){this.batcher=null,this.batch=null,this.roundPixels=0,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}get blendMode(){return this.mesh.groupBlendMode}reset(){this.mesh=null,this.texture=null,this.batcher=null,this.batch=null}packIndex(t,e,s){const i=this.geometry.indices;for(let r=0;r<i.length;r++)t[e++]=i[r]+s}packAttributes(t,e,s,i){const r=this.mesh,n=this.geometry,a=r.groupTransform,o=i<<16|65535&this.roundPixels,h=a.a,l=a.b,c=a.c,u=a.d,d=a.tx,p=a.ty,f=n.positions,g=n.getBuffer("aUV"),x=g.data;let m=x;const _=this.texture.textureMatrix;_.isSimple||(m=this._transformedUvs,this._textureMatrixUpdateId===_._updateID&&this._uvUpdateId===g._updateID||((!m||m.length<x.length)&&(m=this._transformedUvs=new Float32Array(x.length)),this._textureMatrixUpdateId=_._updateID,this._uvUpdateId=g._updateID,_.multiplyUvs(x,m)));const y=r.groupColorAlpha;for(let i=0;i<f.length;i+=2){const r=f[i],n=f[i+1];t[s]=h*r+c*n+d,t[s+1]=l*r+u*n+p,t[s+2]=m[i],t[s+3]=m[i+1],e[s+4]=y,e[s+5]=o,s+=6}}get vertexSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}},5060:(t,e,s)=>{"use strict";s.d(e,{u:()=>h});var i=s(949),r=s(1132),n=s(6011),a=s(4670);const o=class t extends n.V{constructor(...e){let s=e[0]??{};s instanceof Float32Array&&((0,a.t)(a.l,"use new MeshGeometry({ positions, uvs, indices }) instead"),s={positions:s,uvs:e[1],indices:e[2]}),s={...t.defaultOptions,...s};const n=s.positions||new Float32Array([0,0,1,0,1,1,0,1]),o=s.uvs||new Float32Array([0,0,1,0,1,1,0,1]),h=s.indices||new Uint32Array([0,1,2,0,2,3]),l=s.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new i.h({data:n,label:"attribute-mesh-positions",shrinkToFit:l,usage:r.S.VERTEX|r.S.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new i.h({data:o,label:"attribute-mesh-uvs",shrinkToFit:l,usage:r.S.VERTEX|r.S.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new i.h({data:h,label:"index-mesh-buffer",shrinkToFit:l,usage:r.S.INDEX|r.S.COPY_DST}),topology:s.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};o.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let h=o},7252:(t,e,s)=>{"use strict";var i=s(8507),r=s(8218),n=s(8734),a=s(4670),o=s(5060);const h=class t extends o.u{constructor(...t){super({});let e=t[0]??{};"number"==typeof e&&((0,a.t)(a.l,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(e){e={...t.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const s=this.verticesX*this.verticesY,i=[],r=[],n=[],a=this.verticesX-1,o=this.verticesY-1,h=this.width/a,l=this.height/o;for(let t=0;t<s;t++){const e=t%this.verticesX,s=t/this.verticesX|0;i.push(e*h,s*l),r.push(e/a,s/o)}const c=a*o;for(let t=0;t<c;t++){const e=t%a,s=t/a|0,i=s*this.verticesX+e,r=s*this.verticesX+e+1,o=(s+1)*this.verticesX+e,h=(s+1)*this.verticesX+e+1;n.push(i,r,o,r,h,o)}this.buffers[0].data=new Float32Array(i),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint32Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};h.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let l=h;const c=class t extends l{constructor(e={}){super({width:(e={...t.defaultOptions,...e}).width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(t){this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,e=this._leftWidth+this._rightWidth,s=this.width>e?1:this.width/e,i=this._topHeight+this._bottomHeight,r=this.height>i?1:this.height/i,n=Math.min(s,r);t[9]=t[11]=t[13]=t[15]=this._topHeight*n,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*n,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*n,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*n,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,s=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=s*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-s*this._bottomHeight,this.getBuffer("aUV").update()}};c.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let u=c;class d{constructor(t){this._gpuSpriteHash=Object.create(null),this._renderer=t}addRenderable(t,e){const s=this._getGpuSprite(t);t._didSpriteUpdate&&this._updateBatchableSprite(t,s),this._renderer.renderPipes.batch.addToBatch(s)}updateRenderable(t){const e=this._gpuSpriteHash[t.uid];t._didSpriteUpdate&&this._updateBatchableSprite(t,e),e.batcher.updateElement(e)}validateRenderable(t){const e=t._texture,s=this._getGpuSprite(t);return s.texture._source!==e._source&&!s.batcher.checkAndUpdateTexture(s,e)}destroyRenderable(t){const e=this._gpuSpriteHash[t.uid];r.Z.return(e),this._gpuSpriteHash[t.uid]=null}_updateBatchableSprite(t,e){t._didSpriteUpdate=!1,e.geometry.update(t),e.texture=t._texture}_getGpuSprite(t){return this._gpuSpriteHash[t.uid]||this._initGPUSprite(t)}_initGPUSprite(t){const e=new n.U;return e.geometry=new u,e.mesh=t,e.texture=t._texture,e.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuSpriteHash[t.uid]=e,t.on("destroyed",(()=>{this.destroyRenderable(t)})),e}destroy(){for(const t in this._gpuSpriteHash)this._gpuSpriteHash[t].geometry.destroy();this._gpuSpriteHash=null,this._renderer=null}}d.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"nineSliceSprite"},i.XO.add(d)},8723:(t,e,s)=>{"use strict";var i=s(8507),r=s(7547),n=s(5099),a=s(2760),o=s(8734),h=s(5060),l=s(9313),c=s(5611),u=s(2067),d=s(6665),p=s(8475),f=s(5811),g=s(4492);const x={name:"tiling-bit",vertex:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;\n\n            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;\n        "},fragment:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n\n            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);\n            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;\n            var unclamped = coord;\n            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);\n\n            var bias = 0.;\n\n            if(unclamped.x == coord.x && unclamped.y == coord.y)\n            {\n                bias = -32.;\n            } \n\n            outColor = textureSampleBias(uTexture, uSampler, coord, bias);\n        "}},m={name:"tiling-bit",vertex:{header:"\n            uniform mat3 uTextureTransform;\n            uniform vec4 uSizeAnchor;\n        \n        ",main:"\n            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;\n\n            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;\n        "},fragment:{header:"\n            uniform sampler2D uTexture;\n            uniform mat3 uMapCoord;\n            uniform vec4 uClampFrame;\n            uniform vec2 uClampOffset;\n        ",main:"\n\n        vec2 coord = vUV + ceil(uClampOffset - vUV);\n        coord = (uMapCoord * vec3(coord, 1.0)).xy;\n        vec2 unclamped = coord;\n        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n        \n        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0\n    \n        "}};let _,y;class b extends p.M{constructor(){_??(_=(0,c.v)({name:"tiling-sprite-shader",bits:[u.Ls,x,d.b]})),y??(y=(0,c.I)({name:"tiling-sprite-shader",bits:[u.mA,m,d.m]}));const t=new f.k({uMapCoord:{value:new l.u,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new l.u,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:y,gpuProgram:_,resources:{localUniforms:new f.k({uTransformMatrix:{value:new l.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:t,uTexture:g.g.EMPTY.source,uSampler:g.g.EMPTY.source.style}})}updateUniforms(t,e,s,i,r,n){const a=this.resources.tilingUniforms,o=n.width,h=n.height,l=n.textureMatrix,c=a.uniforms.uTextureTransform;c.set(s.a*o/t,s.b*o/e,s.c*h/t,s.d*h/e,s.tx/t,s.ty/e),c.invert(),a.uniforms.uMapCoord=l.mapCoord,a.uniforms.uClampFrame=l.uClampFrame,a.uniforms.uClampOffset=l.uClampOffset,a.uniforms.uTextureTransform=c,a.uniforms.uSizeAnchor[0]=t,a.uniforms.uSizeAnchor[1]=e,a.uniforms.uSizeAnchor[2]=i,a.uniforms.uSizeAnchor[3]=r,n&&(this.resources.uTexture=n.source,this.resources.uSampler=n.source.style)}}class S extends h.u{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}const v=new S;class w{constructor(t){this._tilingSpriteDataHash=Object.create(null),this._renderer=t}validateRenderable(t){const e=this._getTilingSpriteData(t),s=e.canBatch;this._updateCanBatch(t);const i=e.canBatch;if(i&&i===s){const{batchableMesh:s}=e;if(s.texture._source!==t.texture._source)return!s.batcher.checkAndUpdateTexture(s,t.texture)}return s!==i}addRenderable(t,e){const s=this._renderer.renderPipes.batch;this._updateCanBatch(t);const i=this._getTilingSpriteData(t),{geometry:r,canBatch:n}=i;if(n){i.batchableMesh||(i.batchableMesh=new o.U);const e=i.batchableMesh;t._didTilingSpriteUpdate&&(t._didTilingSpriteUpdate=!1,this._updateBatchableMesh(t),e.geometry=r,e.mesh=t,e.texture=t._texture),e.roundPixels=this._renderer._roundPixels|t._roundPixels,s.addToBatch(e)}else s.break(e),i.shader||(i.shader=new b),this.updateRenderable(t),e.add(t)}execute(t){const{shader:e}=this._tilingSpriteDataHash[t.uid];e.groups[0]=this._renderer.globalUniforms.bindGroup;const s=e.resources.localUniforms.uniforms;s.uTransformMatrix=t.groupTransform,s.uRound=this._renderer._roundPixels|t._roundPixels,(0,a.V)(t.groupColorAlpha,s.uColor,0),this._renderer.encoder.draw({geometry:v,shader:e,state:r.U.default2d})}updateRenderable(t){const e=this._getTilingSpriteData(t),{canBatch:s}=e;if(s){const{batchableMesh:s}=e;t._didTilingSpriteUpdate&&this._updateBatchableMesh(t),s.batcher.updateElement(s)}else if(t._didTilingSpriteUpdate){const{shader:s}=e;s.updateUniforms(t.width,t.height,t._tileTransform.matrix,t.anchor.x,t.anchor.y,t.texture)}t._didTilingSpriteUpdate=!1}destroyRenderable(t){const e=this._getTilingSpriteData(t);e.batchableMesh=null,e.shader?.destroy(),this._tilingSpriteDataHash[t.uid]=null}_getTilingSpriteData(t){return this._tilingSpriteDataHash[t.uid]||this._initTilingSpriteData(t)}_initTilingSpriteData(t){const e=new h.u({indices:v.indices,positions:v.positions.slice(),uvs:v.uvs.slice()});return this._tilingSpriteDataHash[t.uid]={canBatch:!0,renderable:t,geometry:e},t.on("destroyed",(()=>{this.destroyRenderable(t)})),this._tilingSpriteDataHash[t.uid]}_updateBatchableMesh(t){const e=this._getTilingSpriteData(t),{geometry:s}=e,i=t.texture.source.style;"repeat"!==i.addressMode&&(i.addressMode="repeat",i.update()),function(t,e){const s=t.texture,i=s.frame.width,r=s.frame.height;let n=0,a=0;t._applyAnchorToTexture&&(n=t.anchor.x,a=t.anchor.y),e[0]=e[6]=-n,e[2]=e[4]=1-n,e[1]=e[3]=-a,e[5]=e[7]=1-a;const o=l.u.shared;o.copyFrom(t._tileTransform.matrix),o.tx/=t.width,o.ty/=t.height,o.invert(),o.scale(t.width/i,t.height/r),function(t,e,s,i){let r=0;const n=t.length/2,a=i.a,o=i.b,h=i.c,l=i.d,c=i.tx,u=i.ty;for(s*=2;r<n;){const e=t[s],i=t[s+1];t[s]=a*e+h*i+c,t[s+1]=o*e+l*i+u,s+=2,r++}}(e,0,0,o)}(t,s.uvs),function(t,e){const s=t.anchor.x,i=t.anchor.y;e[0]=-s*t.width,e[1]=-i*t.height,e[2]=(1-s)*t.width,e[3]=-i*t.height,e[4]=(1-s)*t.width,e[5]=(1-i)*t.height,e[6]=-s*t.width,e[7]=(1-i)*t.height}(t,s.positions)}destroy(){for(const t in this._tilingSpriteDataHash)this.destroyRenderable(this._tilingSpriteDataHash[t].renderable);this._tilingSpriteDataHash=null,this._renderer=null}_updateCanBatch(t){const e=this._getTilingSpriteData(t),s=t.texture;let i=!0;return this._renderer.type===n.W.WEBGL&&(i=this._renderer.context.supports.nonPowOf2wrapping),e.canBatch=s.textureMatrix.isSimple&&(i||s.source.isPowerOfTwo),e.canBatch}}w.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"tilingSprite"},i.XO.add(w)},7703:(t,e,s)=>{"use strict";var i=s(8507),r=s(4589),n=s(2233),a=s(1761),o=s(2927),h=s(9252),l=s(4492),c=s(4486),u=s(4670);class d extends c.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,u.t)(u.l,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,u.t)(u.l,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,u.t)(u.l,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,u.t)(u.l,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,u.t)(u.l,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture.destroy();this.chars=null,t&&(this.pages.forEach((t=>t.texture.destroy(!0))),this.pages=null)}}var p=s(1979),f=s(8291),g=s(2577),x=s(7608),m=s(8293),_=s(4016),y=s(1242),b=s(3548);function S(t){if(""===t)return[];"string"==typeof t&&(t=[t]);const e=[];for(let s=0,i=t.length;s<i;s++){const i=t[s];if(Array.isArray(i)){if(2!==i.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(0===i[0].length||0===i[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const t=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<t)throw new Error("[BitmapFont]: Invalid character range.");for(let i=t,r=s;i<=r;i++)e.push(String.fromCharCode(i))}else e.push(...Array.from(i))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}class v extends d{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=4,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const e=t,s=e.style.clone();e.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=l.g.WHITE,s._fill.fill=null);const i=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const r=(0,y.Z)(s);e.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/i):s.fontSize=this.baseRenderedFontSize=i,this._style=s,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,this.fontMetrics=_.P.measureFont(r),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(t){const e=S(t).filter((t=>!this._currentChars.includes(t))).filter(((t,e,s)=>s.indexOf(t)===e));if(!e.length)return;let s;this._currentChars=[...this._currentChars,...e],s=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex];let{canvas:i,context:r}=s.canvasAndContext,n=s.texture.source;const a=this._style;let o=this._currentX,c=this._currentY;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u,p="italic"===a.fontStyle?2:1;let f=0,g=!1;for(let t=0;t<e.length;t++){const s=e[t],x=_.P.measureText(s,a,i,!1);x.lineHeight=x.height;const m=p*x.width*u,y=m+2*d,b=x.height*u+2*d;if(g=!1,"\n"!==s&&"\r"!==s&&"\t"!==s&&" "!==s&&(g=!0,f=Math.ceil(Math.max(b,f))),o+y>512&&(c+=f,f=b,o=0,c+f>512)){n.update();const t=this._nextPage();i=t.canvasAndContext.canvas,r=t.canvasAndContext.context,n=t.texture.source,c=0}const S=m/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[s]={id:s.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:S,kerning:{}},g){this._drawGlyph(r,x,o+d,c+d,u,a);const t=n.width*u,e=n.height*u,i=new h.M(o/t*n.width,c/e*n.height,y/t*n.width,b/e*n.height);this.chars[s].texture=new l.g({source:n,frame:i}),o+=Math.ceil(y)}}n.update(),this._currentX=o,this._currentY=c,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return(0,u.t)(u.l,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const s=this._measureCache;for(let i=0;i<t.length;i++){const r=t[i];for(let t=0;t<this._currentChars.length;t++){const i=this._currentChars[t];let n=s[r];n||(n=s[r]=e.measureText(r).width);let a=s[i];a||(a=s[i]=e.measureText(i).width);let o=e.measureText(r+i).width,h=o-(n+a);h&&(this.chars[r].kerning[i]=h),o=e.measureText(r+i).width,h=o-(n+a),h&&(this.chars[i].kerning[r]=h)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=x.N.getOptimalCanvasAndContext(512,512,t);this._setupContext(e.context,this._style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i={canvasAndContext:e,texture:new l.g({source:new m.b({resource:e.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload"})})};return this.pages[this._currentPageIndex]=i,i}_setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=(0,y.Z)(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const i=e._stroke,r=i?.width??0;if(i&&(t.lineWidth=r,t.lineJoin=i.join,t.miterLimit=i.miterLimit,t.strokeStyle=(0,b.r)(i,t)),e._fill&&(t.fillStyle=(0,b.r)(e._fill,t)),e.dropShadow){const i=e.dropShadow,r=g.Q.shared.setValue(i.color).toArray(),n=i.blur*s,a=i.distance*s;t.shadowColor=`rgba(${255*r[0]},${255*r[1]},${255*r[2]},${i.alpha})`,t.shadowBlur=n,t.shadowOffsetX=Math.cos(i.angle)*a,t.shadowOffsetY=Math.sin(i.angle)*a}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,s,i,r,n){const a=e.text,o=e.fontProperties,h=n._stroke,l=(h?.width??0)*r,c=s+l/2,u=i-l/2,d=o.descent*r,p=e.lineHeight*r;n.stroke&&l&&t.strokeText(a,c,u+p-d),n._fill&&t.fillText(a,c,u+p-d)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];x.N.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}}function w(t,e,s){const i={width:0,height:0,offsetY:0,scale:e.fontSize/s.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=s.baseLineOffset;let r=i.lines[0],n=null,a=!0;const o={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=t=>{const e=r.width;for(let s=0;s<o.index;s++){const i=t.positions[s];r.chars.push(t.chars[s]),r.charPositions.push(i+e)}r.width+=t.width,a=!1,o.width=0,o.index=0,o.chars.length=0},l=()=>{let t=r.chars.length-1,e=r.chars[t];for(;" "===e;)r.width-=s.chars[e].xAdvance,e=r.chars[--t];i.width=Math.max(i.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,i.lines.push(r),i.height+=s.lineHeight},c=s.baseMeasurementFontSize/e.fontSize,u=e.letterSpacing*c,d=e.wordWrapWidth*c;for(let i=0;i<t.length+1;i++){let c;const p=i===t.length;p||(c=t[i]);const f=s.chars[c]||s.chars[" "];if(/(?:\s)/.test(c)||"\r"===c||"\n"===c||p){if(!a&&e.wordWrap&&r.width+o.width-u>d?(l(),h(o),p||r.charPositions.push(0)):(o.start=r.width,h(o),p||r.charPositions.push(0)),"\r"===c||"\n"===c)0!==r.width&&l();else if(!p){const t=f.xAdvance+(f.kerning[n]||0)+u;r.width+=t,r.spaceWidth=t,r.spacesIndex.push(r.charPositions.length),r.chars.push(c)}}else{const t=f.kerning[n]||0,e=f.xAdvance+t+u;o.positions[o.index++]=o.width+t,o.chars.push(c),o.width+=e}n=c}return l(),"center"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],i=t.width/2-s.width/2;for(let t=0;t<s.charPositions.length;t++)s.charPositions[t]+=i}}(i):"right"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],i=t.width-s.width;for(let t=0;t<s.charPositions.length;t++)s.charPositions[t]+=i}}(i):"justify"===e.align&&function(t){const e=t.width;for(let s=0;s<t.lines.length;s++){const i=t.lines[s];let r=0,n=i.spacesIndex[r++],a=0;const o=i.spacesIndex.length,h=(e-i.width)/o;for(let t=0;t<i.charPositions.length;t++)t===n&&(n=i.spacesIndex[r++],a+=h),i.charPositions[t]+=a}}(i),i}const T=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){let s=`${e.fontFamily}-bitmap`,i=!0;if(e._fill.fill&&(s+=e._fill.fill.uid,i=!1),!p.l.has(s)){const t=new v({style:e,overrideFill:i,overrideSize:!0,...this.defaultOptions});t.once("destroy",(()=>p.l.remove(s))),p.l.set(s,t)}const r=p.l.get(s);return r.ensureCharacters?.(t),r}getLayout(t,e){const s=this.getFont(t,e);return w([...t],e,s)}measureText(t,e){return this.getLayout(t,e)}install(...t){let e=t[0];"string"==typeof e&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},(0,u.t)(u.l,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=e?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const i=e.style,r=i instanceof f.x?i:new f.x(i),n=null!==r._fill.fill&&void 0!==r._fill.fill,a=new v({style:r,overrideFill:n,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),o=S(e.chars);return a.ensureCharacters(o.join("")),p.l.set(`${s}-bitmap`,a),a.once("destroy",(()=>p.l.remove(`${s}-bitmap`))),a}uninstall(t){const e=`${t}-bitmap`,s=p.l.get(e);s&&(p.l.remove(e),s.destroy())}};class M extends d{constructor(t,e){super();const{textures:s,data:i}=t;Object.keys(i.pages).forEach((t=>{const e=i.pages[parseInt(t,10)],r=s[e.id];this.pages.push({texture:r})})),Object.keys(i.chars).forEach((t=>{const e=i.chars[t],{frame:r,source:n}=s[e.page],a=new h.M(e.x+r.x,e.y+r.y,e.width,e.height),o=new l.g({source:n,frame:a});this.chars[t]={id:t.codePointAt(0),xOffset:e.xOffset,yOffset:e.yOffset,xAdvance:e.xAdvance,kerning:e.kerning??{},texture:o}})),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){T.install(t)}static uninstall(t){T.uninstall(t)}}const P={test:t=>"string"==typeof t&&t.startsWith("info face="),parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const i=e[t].match(/^[a-z]+/gm)[0],r=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),n={};for(const t in r){const e=r[t].split("="),s=e[0],i=e[1].replace(/"/gm,""),a=parseFloat(i),o=isNaN(a)?i:a;n[s]=o}s[i].push(n)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=s.info,[n]=s.common,[a]=s.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(r.size,10),i.fontFamily=r.face,i.lineHeight=parseInt(n.lineHeight,10);const o=s.page;for(let t=0;t<o.length;t++)i.pages.push({id:parseInt(o[t].id,10)||0,file:o[t].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(n.base,10);const l=s.char;for(let t=0;t<l.length;t++){const e=l[t],s=parseInt(e.id,10);let r=e.letter??e.char??String.fromCharCode(s);"space"===r&&(r=" "),h[s]=r,i.chars[r]={id:s,page:parseInt(e.page,10)||0,x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xOffset:parseInt(e.xoffset,10),yOffset:parseInt(e.yoffset,10),xAdvance:parseInt(e.xadvance,10),kerning:{}}}const c=s.kerning||[];for(let t=0;t<c.length;t++){const e=parseInt(c[t].first,10),s=parseInt(c[t].second,10),r=parseInt(c[t].amount,10);i.chars[h[s]].kerning[h[e]]=r}return i}},C={test(t){const e=t;return"string"!=typeof e&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},s=t.getElementsByTagName("info")[0],i=t.getElementsByTagName("common")[0],r=t.getElementsByTagName("distanceField")[0];r&&(e.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const n=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");e.fontSize=parseInt(s.getAttribute("size"),10),e.fontFamily=s.getAttribute("face"),e.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let t=0;t<n.length;t++)e.pages.push({id:parseInt(n[t].getAttribute("id"),10)||0,file:n[t].getAttribute("file")});const h={};e.baseLineOffset=e.lineHeight-parseInt(i.getAttribute("base"),10);for(let t=0;t<a.length;t++){const s=a[t],i=parseInt(s.getAttribute("id"),10);let r=s.getAttribute("letter")??s.getAttribute("char")??String.fromCharCode(i);"space"===r&&(r=" "),h[i]=r,e.chars[r]={id:i,page:parseInt(s.getAttribute("page"),10)||0,x:parseInt(s.getAttribute("x"),10),y:parseInt(s.getAttribute("y"),10),width:parseInt(s.getAttribute("width"),10),height:parseInt(s.getAttribute("height"),10),xOffset:parseInt(s.getAttribute("xoffset"),10),yOffset:parseInt(s.getAttribute("yoffset"),10),xAdvance:parseInt(s.getAttribute("xadvance"),10),kerning:{}}}for(let t=0;t<o.length;t++){const s=parseInt(o[t].getAttribute("first"),10),i=parseInt(o[t].getAttribute("second"),10),r=parseInt(o[t].getAttribute("amount"),10);e.chars[h[i]].kerning[h[s]]=r}return e}},k=t=>!("string"!=typeof t||!t.includes("<font>"))&&C.test(a.e.get().parseXML(t)),A=t=>C.parse(a.e.get().parseXML(t)),B=[".xml",".fnt"],F={extension:i.Ag.CacheParser,test:t=>t instanceof M,getCacheableAssets(t,e){const s={};return t.forEach((t=>{s[t]=e})),s[`${e.fontFamily}-bitmap`]=e,s}},R={extension:{type:i.Ag.LoadParser,priority:r.T.Normal},test:t=>B.includes(o.A.extname(t).toLowerCase()),testParse:async t=>P.test(t)||k(t),async parse(t,e,s){const i=P.test(t)?P.parse(t):A(t),{src:r}=e,{pages:a}=i,h=[];for(let t=0;t<a.length;++t){const e=a[t].file;let s=o.A.join(o.A.dirname(r),e);s=(0,n.Y)(s,r),h.push(s)}const l=await s.load(h),c=h.map((t=>l[t]));return new M({data:i,textures:c},r)},async load(t,e){const s=await a.e.get().fetch(t);return await s.text()},async unload(t,e,s){await Promise.all(t.pages.map((t=>s.unload(t.texture.source._sourceOrigin)))),t.destroy()}};var z=s(8218),U=s(4263),W=s(4835);class I extends U.mc{constructor(t){t instanceof W.T&&(t={context:t});const{context:e,roundPixels:s,...i}=t||{};super({label:"Graphics",...i}),this.canBundle=!0,this.renderPipeId="graphics",this._roundPixels=0,this._context=e||(this._ownedContext=new W.T),this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}onViewUpdate(){if(this._didChangeId+=4096,this._didGraphicsUpdate=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):!0!==t&&!0!==t?.context||this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new I(this._context.clone()):(this._ownedContext=null,new I(this._context))}lineStyle(t,e,s){(0,u.t)(u.l,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return t&&(i.width=t),e&&(i.color=e),s&&(i.alpha=s),this.context.strokeStyle=i,this}beginFill(t,e){(0,u.t)(u.l,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t&&(s.color=t),e&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){(0,u.t)(u.l,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return t.width===W.T.defaultStrokeStyle.width&&t.color===W.T.defaultStrokeStyle.color&&t.alpha===W.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...t){return(0,u.t)(u.l,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return(0,u.t)(u.l,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return(0,u.t)(u.l,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return(0,u.t)(u.l,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return(0,u.t)(u.l,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return(0,u.t)(u.l,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}var H=s(9313),G=s(5611),O=s(4459),L=s(4e3),D=s(6665),E=s(6040),V=s(8475),$=s(5811),X=s(8815);const N={name:"local-uniform-msdf-bit",vertex:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "},fragment:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         ",main:" \n            outColor = vColor * calculateMSDFAlpha(outColor, localUniforms.uDistance);\n        "}},q={name:"local-uniform-msdf-bit",vertex:{header:"\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "},fragment:{header:"\n            uniform float uDistance;\n         ",main:" \n            outColor = vColor * calculateMSDFAlpha(outColor, uDistance);\n        "}},Y={name:"msdf-bit",fragment:{header:"\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, distance:f32) -> f32 {\n                \n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n            \n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                return alpha;\n            }\n        "}},j={name:"msdf-bit",fragment:{header:"\n            float calculateMSDFAlpha(vec4 msdfColor, float distance) {\n                \n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n               \n                // SDF\n                median = min(median, msdfColor.a);\n            \n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n           \n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                return alpha;\n            }\n        "}};class K extends V.M{constructor(){const t=new $.k({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new H.u,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}}),e=(0,X.c)(),s=(0,G.v)({name:"sdf-shader",bits:[O.F,(0,L._)(e),N,Y,D.b]});super({glProgram:(0,G.I)({name:"sdf-shader",bits:[O.a,(0,L.P)(e),q,j,D.m]}),gpuProgram:s,resources:{localUniforms:t,batchSamplers:(0,E.n)(e)}})}}class Z{constructor(t){this._gpuBitmapText={},this._renderer=t}validateRenderable(t){const e=this._getGpuBitmapText(t);return t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,e)),this._renderer.renderPipes.graphics.validateRenderable(e)}addRenderable(t,e){const s=this._getGpuBitmapText(t);Q(t,s),t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,s)),this._renderer.renderPipes.graphics.addRenderable(s,e),s.context.customShader&&this._updateDistanceField(t)}destroyRenderable(t){this._destroyRenderableByUid(t.uid)}_destroyRenderableByUid(t){z.Z.return(this._gpuBitmapText[t]),this._gpuBitmapText[t]=null}updateRenderable(t){const e=this._getGpuBitmapText(t);Q(t,e),this._renderer.renderPipes.graphics.updateRenderable(e),e.context.customShader&&this._updateDistanceField(t)}_updateContext(t,e){const{context:s}=e,i=T.getFont(t.text,t._style);s.clear(),"none"!==i.distanceField.type&&(s.customShader||(this._sdfShader||(this._sdfShader=new K),s.customShader=this._sdfShader));const r=Array.from(t.text),n=t._style;let a=(n._stroke?.width||0)/2;a+=i.baseLineOffset;const o=w(r,n,i);let h=0;const l=n.padding,c=o.scale;s.translate(-t._anchor._x*o.width-l,-t._anchor._y*(o.height+o.offsetY)-l).scale(c,c);const u=n._fill.color;for(let t=0;t<o.lines.length;t++){const e=o.lines[t];for(let t=0;t<e.charPositions.length;t++){const n=r[h++],o=i.chars[n];o?.texture&&s.texture(o.texture,u||"black",Math.round(e.charPositions[t]+o.xOffset),Math.round(a+o.yOffset))}a+=i.lineHeight}}_getGpuBitmapText(t){return this._gpuBitmapText[t.uid]||this.initGpuText(t)}initGpuText(t){const e=z.Z.get(I);return this._gpuBitmapText[t.uid]=e,this._updateContext(t,e),t.on("destroyed",(()=>{this.destroyRenderable(t)})),this._gpuBitmapText[t.uid]}_updateDistanceField(t){const e=this._getGpuBitmapText(t).context,s=t._style.fontFamily,i=p.l.get(`${s}-bitmap`),{a:r,b:n,c:a,d:o}=t.groupTransform,h=Math.sqrt(r*r+n*n),l=Math.sqrt(a*a+o*o),c=(Math.abs(h)+Math.abs(l))/2,u=i.baseRenderedFontSize/t._style.fontSize,d=t.resolution??this._renderer.resolution,f=c*i.distanceField.range*(1/u)*d;e.customShader.resources.localUniforms.uniforms.uDistance=f}destroy(){for(const t in this._gpuBitmapText)this._destroyRenderableByUid(t);this._gpuBitmapText=null,this._sdfShader?.destroy(!0),this._sdfShader=null,this._renderer=null}}function Q(t,e){e.groupTransform=t.groupTransform,e.groupColorAlpha=t.groupColorAlpha,e.groupColor=t.groupColor,e.groupBlendMode=t.groupBlendMode,e.globalDisplayStatus=t.globalDisplayStatus,e.groupTransform=t.groupTransform,e.localDisplayStatus=t.localDisplayStatus,e.groupAlpha=t.groupAlpha,e._roundPixels=t._roundPixels}Z.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"bitmapText"},i.XO.add(Z,R,F)},7559:(t,e,s)=>{"use strict";var i=s(8507),r=s(4492),n=s(2048),a=s(8218),o=s(8422);class h{constructor(t){this._gpuText=Object.create(null),this._renderer=t}validateRenderable(t){const e=this._getGpuText(t),s=t._getKey();return e.textureNeedsUploading?(e.textureNeedsUploading=!1,!0):e.currentKey!==s}addRenderable(t){const e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),this._renderer.renderPipes.batch.addToBatch(e)}updateRenderable(t){const e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),e.batcher.updateElement(e)}destroyRenderable(t){this._destroyRenderableById(t.uid)}_destroyRenderableById(t){const e=this._gpuText[t];this._renderer.htmlText.decreaseReferenceCount(e.currentKey),a.Z.return(e.batchableSprite),this._gpuText[t]=null}_updateText(t){const e=t._getKey(),s=this._getGpuText(t),i=s.batchableSprite;s.currentKey!==e&&this._updateGpuText(t).catch((t=>{console.error(t)})),t._didTextUpdate=!1;const r=t._style.padding;(0,n.y)(i.bounds,t._anchor,i.texture,r)}async _updateGpuText(t){t._didTextUpdate=!1;const e=this._getGpuText(t);if(e.generatingTexture)return;const s=t._getKey();this._renderer.htmlText.decreaseReferenceCount(e.currentKey),e.generatingTexture=!0,e.currentKey=s;const i=t.resolution??this._renderer.resolution,r=await this._renderer.htmlText.getManagedTexture(t.text,i,t._style,t._getKey()),a=e.batchableSprite;a.texture=e.texture=r,e.generatingTexture=!1,e.textureNeedsUploading=!0,t.onViewUpdate();const o=t._style.padding;(0,n.y)(a.bounds,t._anchor,a.texture,o)}_getGpuText(t){return this._gpuText[t.uid]||this.initGpuText(t)}initGpuText(t){const e={texture:r.g.EMPTY,currentKey:"--",batchableSprite:a.Z.get(o.K),textureNeedsUploading:!1,generatingTexture:!1},s=e.batchableSprite;return s.renderable=t,s.texture=r.g.EMPTY,s.bounds={minX:0,maxX:1,minY:0,maxY:0},s.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuText[t.uid]=e,t.on("destroyed",(()=>{this.destroyRenderable(t)})),e}destroy(){for(const t in this._gpuText)this._destroyRenderableById(t);this._gpuText=null,this._renderer=null}}h.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"htmlText"};var l=s(2437),c=s(5099),u=s(1761),d=s(268),p=s(2558);const f="http://www.w3.org/2000/svg",g="http://www.w3.org/1999/xhtml";class x{constructor(){this.svgRoot=document.createElementNS(f,"svg"),this.foreignObject=document.createElementNS(f,"foreignObject"),this.domElement=document.createElementNS(g,"div"),this.styleElement=document.createElementNS(g,"style"),this.image=new Image;const{foreignObject:t,svgRoot:e,styleElement:s,domElement:i}=this;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",e.appendChild(t),t.appendChild(s),t.appendChild(i)}}var m=s(8291),_=s(8011),y=s(2577);function b(t){const e=y.Q.shared.setValue(t.color).setAlpha(t.alpha).toHexa(),s=`${Math.round(Math.cos(t.angle)*t.distance)}px ${Math.round(Math.sin(t.angle)*t.distance)}px`;return t.blur>0?`text-shadow: ${s} ${t.blur}px ${e}`:`text-shadow: ${s} ${e}`}function S(t){return[`-webkit-text-stroke-width: ${t.width}px`,`-webkit-text-stroke-color: ${y.Q.shared.setValue(t.color).toHex()}`,`text-stroke-width: ${t.width}px`,`text-stroke-color: ${y.Q.shared.setValue(t.color).toHex()}`,"paint-order: stroke"].join(";")}const v={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},w={fill:t=>`color: ${y.Q.shared.setValue(t).toHex()}`,breakWords:t=>"word-wrap: "+(t?"break-all":"break-word"),stroke:S,dropShadow:b};class T extends m.x{constructor(t={}){super(t),this._cssOverrides=[],this.cssOverrides??(this.cssOverrides=t.cssOverrides),this.tagStyles=t.tagStyles??{}}set cssOverrides(t){this._cssOverrides=t instanceof Array?t:[t],this.update()}get cssOverrides(){return this._cssOverrides}_generateKey(){return this._styleKey=(0,_.V)(this)+this._cssOverrides.join("-"),this._styleKey}update(){this._cssStyle=null,super.update()}clone(){return new T({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides})}get cssStyle(){return this._cssStyle||(this._cssStyle=function(t){const e=t._stroke,s=t._fill,i=[`div { ${[`color: ${y.Q.shared.setValue(s.color).toHex()}`,`font-size: ${t.fontSize}px`,`font-family: ${t.fontFamily}`,`font-weight: ${t.fontWeight}`,`font-style: ${t.fontStyle}`,`font-variant: ${t.fontVariant}`,`letter-spacing: ${t.letterSpacing}px`,`text-align: ${t.align}`,`padding: ${t.padding}px`,`white-space: ${"pre"===t.whiteSpace&&t.wordWrap?"pre-wrap":t.whiteSpace}`,...t.lineHeight?[`line-height: ${t.lineHeight}px`]:[],...t.wordWrap?["word-wrap: "+(t.breakWords?"break-all":"break-word"),`max-width: ${t.wordWrapWidth}px`]:[],...e?[S(e)]:[],...t.dropShadow?[b(t.dropShadow)]:[],...t.cssOverrides].join(";")} }`];return function(t,e){for(const s in t){const i=t[s],r=[];for(const t in i)w[t]?r.push(w[t](i[t])):v[t]&&r.push(v[t].replace("{{VALUE}}",i[t]));e.push(`${s} { ${r.join(";")} }`)}}(t.tagStyles,i),i.join(" ")}(this)),this._cssStyle}addOverride(...t){const e=t.filter((t=>!this.cssOverrides.includes(t)));e.length>0&&(this.cssOverrides.push(...e),this.update())}removeOverride(...t){const e=t.filter((t=>this.cssOverrides.includes(t)));e.length>0&&(this.cssOverrides=this.cssOverrides.filter((t=>!e.includes(t))),this.update())}set fill(t){"string"!=typeof t&&"number"!=typeof t&&(0,d.R)("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=t}set stroke(t){t&&"string"!=typeof t&&"number"!=typeof t&&(0,d.R)("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=t}}var M=s(1979);async function P(t,e){const s=await async function(t){const e=await u.e.get().fetch(t),s=await e.blob(),i=new FileReader;return await new Promise(((t,e)=>{i.onloadend=()=>t(i.result),i.onerror=e,i.readAsDataURL(s)}))}(e);return`@font-face {\n        font-family: "${t.fontFamily}";\n        src: url('${s}');\n        font-weight: ${t.fontWeight};\n        font-style: ${t.fontStyle};\n    }`}const C=new Map;var k=s(7608),A=s(4016);let B;class F{constructor(t){this._activeTextures={},this._renderer=t,this._createCanvas=t.type===c.W.WEBGPU}getTexture(t){return this._buildTexturePromise(t.text,t.resolution,t.style)}getManagedTexture(t,e,s,i){if(this._activeTextures[i])return this._increaseReferenceCount(i),this._activeTextures[i].promise;const r=this._buildTexturePromise(t,e,s).then((t=>(this._activeTextures[i].texture=t,t)));return this._activeTextures[i]={texture:null,promise:r,usageCount:1},r}async _buildTexturePromise(t,e,s){const i=a.Z.get(x),r=function(t,e){const s=e.fontFamily,i=[],r={},n=t.match(/font-family:([^;"\s]+)/g);function a(t){r[t]||(i.push(t),r[t]=!0)}if(Array.isArray(s))for(let t=0;t<s.length;t++)a(s[t]);else a(s);n&&n.forEach((t=>{a(t.split(":")[1].trim())}));for(const t in e.tagStyles)a(e.tagStyles[t].fontFamily);return i}(t,s),n=await async function(t,e,s){const i=t.filter((t=>M.l.has(`${t}-and-url`))).map(((t,i)=>{if(!C.has(t)){const{url:r}=M.l.get(`${t}-and-url`);0===i?C.set(t,P(e,r)):C.set(t,P({fontWeight:s.fontWeight,fontStyle:s.fontStyle,fontFamily:t},r))}return C.get(t)}));return(await Promise.all(i)).join("\n")}(r,s,T.defaultTextStyle),o=function(t,e,s,i){i=i||B||(B=new x);const{domElement:r,styleElement:n,svgRoot:a}=i;r.innerHTML=`<style>${e.cssStyle}</style><div>${t}</div>`,r.setAttribute("style","transform-origin: top left; display: inline-block"),s&&(n.textContent=s),document.body.appendChild(a);const o=r.getBoundingClientRect();a.remove();const h=A.P.measureFont(e.fontStyle).descent;return{width:o.width,height:o.height+h}}(t,s,n,i),h=Math.ceil(Math.ceil(Math.max(1,o.width)+2*s.padding)*e),l=Math.ceil(Math.ceil(Math.max(1,o.height)+2*s.padding)*e),c=i.image;c.width=0|h,c.height=0|l;const d=function(t,e,s,i,r){const{domElement:n,styleElement:a,svgRoot:o}=r;n.innerHTML=`<style>${e.cssStyle}</style><div>${t}</div>`,n.setAttribute("style",`transform: scale(${s});transform-origin: top left; display: inline-block`),a.textContent=i;const{width:h,height:l}=r.image;return o.setAttribute("width",h.toString()),o.setAttribute("height",l.toString()),(new XMLSerializer).serializeToString(o)}(t,s,e,n,i);await function(t,e,s){return new Promise((async i=>{s&&await new Promise((t=>setTimeout(t,100))),t.onload=()=>{i()},t.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,t.crossOrigin="anonymous"}))}(c,d,function(){const{userAgent:t}=u.e.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}()&&r.length>0);let f=c;this._createCanvas&&(f=function(t,e){const s=k.N.getOptimalCanvasAndContext(t.width,t.height,e),{context:i}=s;return i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),k.N.returnCanvasAndContext(s),s.canvas}(c,e));const g=(0,p.M)(f,c.width,c.height,e);return this._createCanvas&&this._renderer.texture.initSource(g.source),a.Z.return(i),g}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){const e=this._activeTextures[t];e&&(e.usageCount--,0===e.usageCount&&(e.texture?this._cleanUp(e):e.promise.then((t=>{e.texture=t,this._cleanUp(e)})).catch((()=>{(0,d.R)("HTMLTextSystem: Failed to clean texture")})),this._activeTextures[t]=null))}_cleanUp(t){l.W.returnTexture(t.texture),t.texture.source.resource=null,t.texture.source.uploadMethodId="unknown"}getReferenceCount(t){return this._activeTextures[t].usageCount}destroy(){this._activeTextures=null}}F.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem,i.Ag.CanvasSystem],name:"htmlText"},F.defaultFontOptions={fontFamily:"Arial",fontStyle:"normal",fontWeight:"normal"},i.XO.add(F),i.XO.add(h)},8291:(t,e,s)=>{"use strict";s.d(e,{x:()=>u});var i=s(4486),r=s(2577),n=s(4670),a=s(7276),o=s(4835),h=s(990),l=s(8011);const c=class t extends i.A{constructor(e={}){super(),function(t){const e=t;if("boolean"==typeof e.dropShadow&&e.dropShadow){const s=u.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??s.alpha,angle:e.dropShadowAngle??s.angle,blur:e.dropShadowBlur??s.blur,color:e.dropShadowColor??s.color,distance:e.dropShadowDistance??s.distance}}if(void 0!==e.strokeThickness){(0,n.t)(n.l,"strokeThickness is now a part of stroke");const s=e.stroke;t.stroke={color:s,width:e.strokeThickness}}if(Array.isArray(e.fill)){(0,n.t)(n.l,"gradient fill is now a fill pattern: `new FillGradient(...)`");const s=new a._(0,0,0,1.7*t.fontSize),i=e.fill.map((t=>r.Q.shared.setValue(t).toNumber()));i.forEach(((t,r)=>{const n=e.fillGradientStops[r]??r/i.length;s.addColorStop(n,t)})),t.fill={fill:s}}}(e);const s={...t.defaultTextStyle,...e};for(const t in s)this[t]=s[t];this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow=null!==e&&"object"==typeof e?{...t.defaultDropShadow,...e}:e?{...t.defaultDropShadow}:null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize="string"==typeof t?parseInt(t,10):t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t,this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._fill=(0,h.M)(0===t?"black":t,o.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._stroke=(0,h.M)(t,o.T.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=(0,l.V)(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const e=t.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){if(this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(e),this._originalFill?.texture&&this._originalFill.texture.destroy(e),this._stroke?.texture&&this._stroke.texture.destroy(e),this._originalStroke?.texture&&this._originalStroke.texture.destroy(e)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}};c.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},c.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let u=c},4016:(t,e,s)=>{"use strict";s.d(e,{P:()=>o});var i=s(1761),r=s(1242);const n={willReadFrequently:!0},a=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0!==e){const s=i.e.get().getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in s||"textLetterSpacing"in s}return e}constructor(t,e,s,i,r,n,a,o,h){this.text=t,this.style=e,this.width=s,this.height=i,this.lines=r,this.lineWidths=n,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=h}static measureText(e=" ",s,i=t._canvas,n=s.wordWrap){const a=`${e}:${s.styleKey}`;if(t._measurementCache[a])return t._measurementCache[a];const o=(0,r.Z)(s),h=t.measureFont(o);0===h.fontSize&&(h.fontSize=s.fontSize,h.ascent=s.fontSize);const l=t.__context;l.font=o;const c=(n?t._wordWrap(e,s,i):e).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let d=0;for(let e=0;e<c.length;e++){const i=t._measureText(c[e],s.letterSpacing,l);u[e]=i,d=Math.max(d,i)}const p=s._stroke?.width||0;let f=d+p;s.dropShadow&&(f+=s.dropShadow.distance);const g=s.lineHeight||h.fontSize+p;let x=Math.max(g,h.fontSize+2*p)+(c.length-1)*(g+s.leading);return s.dropShadow&&(x+=s.dropShadow.distance),new t(e,s,f,x,c,u,g+s.leading,d,h)}static _measureText(e,s,i){let r=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(i.letterSpacing=`${s}px`,i.textLetterSpacing=`${s}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(e).width;return n>0&&(r?n-=s:n+=(t.graphemeSegmenter(e).length-1)*s),n}static _wordWrap(e,s,i=t._canvas){const r=i.getContext("2d",n);let a=0,o="",h="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=s,d=t._collapseSpaces(u),p=t._collapseNewlines(u);let f=!d;const g=s.wordWrapWidth+c,x=t._tokenize(e);for(let e=0;e<x.length;e++){let i=x[e];if(t._isNewline(i)){if(!p){h+=t._addLine(o),f=!d,o="",a=0;continue}i=" "}if(d){const e=t.isBreakingSpace(i),s=t.isBreakingSpace(o[o.length-1]);if(e&&s)continue}const n=t._getFromCache(i,c,l,r);if(n>g)if(""!==o&&(h+=t._addLine(o),o="",a=0),t.canBreakWords(i,s.breakWords)){const e=t.wordWrapSplit(i);for(let n=0;n<e.length;n++){let u=e[n],d=u,p=1;for(;e[n+p];){const r=e[n+p];if(t.canBreakChars(d,r,i,n,s.breakWords))break;u+=r,d=r,p++}n+=p-1;const x=t._getFromCache(u,c,l,r);x+a>g&&(h+=t._addLine(o),f=!1,o="",a=0),o+=u,a+=x}}else{o.length>0&&(h+=t._addLine(o),o="",a=0);const s=e===x.length-1;h+=t._addLine(i,!s),f=!1,o="",a=0}else n+a>g&&(f=!1,h+=t._addLine(o),o="",a=0),(o.length>0||!t.isBreakingSpace(i)||f)&&(o+=i,a+=n)}return h+=t._addLine(o,!1),h}static _addLine(e,s=!0){return e=t._trimRight(e),s?`${e}\n`:e}static _getFromCache(e,s,i,r){let n=i[e];return"number"!=typeof n&&(n=t._measureText(e,s,r)+s,i[e]=n),n}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(e){if("string"!=typeof e)return"";for(let s=e.length-1;s>=0;s--){const i=e[s];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static _isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,s){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const s=[];let i="";if("string"!=typeof e)return s;for(let r=0;r<e.length;r++){const n=e[r],a=e[r+1];t.isBreakingSpace(n,a)||t._isNewline(n)?(""!==i&&(s.push(i),i=""),s.push(n)):i+=n}return""!==i&&s.push(i),s}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,i,r){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];const s=t._context;s.font=e;const i=s.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),r={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return t._fonts[e]=r,r}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let e;try{const s=new OffscreenCanvas(0,0),r=s.getContext("2d",n);if(r?.measureText)return t.__canvas=s,s;e=i.e.get().createCanvas()}catch(t){e=i.e.get().createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",n)),t.__context}};a.METRICS_STRING="|q",a.BASELINE_SYMBOL="M",a.BASELINE_MULTIPLIER=1.4,a.HEIGHT_MULTIPLIER=2,a.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>[...t.segment(e)].map((t=>t.segment))}return t=>[...t]})(),a.experimentalLetterSpacing=!1,a._fonts={},a._newlines=[10,13],a._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],a._measurementCache={};let o=a},1242:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});const i=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function r(t){const e="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize;let s=t.fontFamily;Array.isArray(t.fontFamily)||(s=t.fontFamily.split(","));for(let t=s.length-1;t>=0;t--){let e=s[t].trim();/([\"\'])[^\'\"]+\1/.test(e)||i.includes(e)||(e=`"${e}"`),s[t]=e}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${s.join(",")}`}},3548:(t,e,s)=>{"use strict";s.d(e,{r:()=>l});var i=s(2577),r=s(9313),n=s(4492),a=s(268),o=s(7276),h=s(2806);function l(t,e){if(t.texture===n.g.WHITE&&!t.fill)return i.Q.shared.setValue(t.color).toHex();if(!t.fill){const s=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(r.u.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),s.setTransform(i),s}if(t.fill instanceof h.m){const s=t.fill,i=e.createPattern(s.texture.source.resource,"repeat"),n=s.transform.copyTo(r.u.shared);return n.scale(s.texture.frame.width,s.texture.frame.height),i.setTransform(n),i}if(t.fill instanceof o._){const s=t.fill;if("linear"===s.type){const t=e.createLinearGradient(s.x0,s.y0,s.x1,s.y1);return s.gradientStops.forEach((e=>{t.addColorStop(e.offset,i.Q.shared.setValue(e.color).toHex())})),t}}return(0,a.R)("FillStyle not recognised",t),"red"}},6958:(t,e,s)=>{"use strict";var i=s(8507),r=s(2048),n=s(8218),a=s(8422);class o{constructor(t){this._gpuText=Object.create(null),this._renderer=t}validateRenderable(t){const e=this._getGpuText(t),s=t._getKey();if(e.currentKey!==s){const s=t.resolution??this._renderer.resolution,{width:i,height:r}=this._renderer.canvasText.getTextureSize(t.text,s,t._style);return 1!==this._renderer.canvasText.getReferenceCount(e.currentKey)||i!==e.texture._source.width||r!==e.texture._source.height}return!1}addRenderable(t,e){const s=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),this._renderer.renderPipes.batch.addToBatch(s)}updateRenderable(t){const e=this._getGpuText(t).batchableSprite;t._didTextUpdate&&this._updateText(t),e.batcher.updateElement(e)}destroyRenderable(t){this._destroyRenderableById(t.uid)}_destroyRenderableById(t){const e=this._gpuText[t];this._renderer.canvasText.decreaseReferenceCount(e.currentKey),n.Z.return(e.batchableSprite),this._gpuText[t]=null}_updateText(t){const e=t._getKey(),s=this._getGpuText(t),i=s.batchableSprite;s.currentKey!==e&&this._updateGpuText(t),t._didTextUpdate=!1;const n=t._style.padding;(0,r.y)(i.bounds,t._anchor,i.texture,n)}_updateGpuText(t){const e=this._getGpuText(t),s=e.batchableSprite;e.texture&&this._renderer.canvasText.decreaseReferenceCount(e.currentKey),e.texture=s.texture=this._renderer.canvasText.getManagedTexture(t),e.currentKey=t._getKey(),s.texture=e.texture}_getGpuText(t){return this._gpuText[t.uid]||this.initGpuText(t)}initGpuText(t){const e={texture:null,currentKey:"--",batchableSprite:n.Z.get(a.K)};return e.batchableSprite.renderable=t,e.batchableSprite.bounds={minX:0,maxX:1,minY:0,maxY:0},e.batchableSprite.roundPixels=this._renderer._roundPixels|t._roundPixels,this._gpuText[t.uid]=e,this._updateText(t),t.on("destroyed",(()=>{this.destroyRenderable(t)})),e}destroy(){for(const t in this._gpuText)this._destroyRenderableById(t);this._gpuText=null,this._renderer=null}}o.extension={type:[i.Ag.WebGLPipes,i.Ag.WebGPUPipes,i.Ag.CanvasPipes],name:"text"};var h=s(2577),l=s(9939),c=s(7608),u=s(2437),d=s(9252);function p(t,e,s){for(let i=0,r=4*s*e;i<e;++i,r+=4)if(0!==t[r+3])return!1;return!0}function f(t,e,s,i,r){const n=4*e;for(let e=i,a=i*n+4*s;e<=r;++e,a+=n)if(0!==t[a+3])return!1;return!0}var g=s(4670),x=s(8291),m=s(2558),_=s(4016),y=s(1242),b=s(3548);class S{constructor(t){this._activeTextures={},this._renderer=t}getTextureSize(t,e,s){const i=_.P.measureText(t||" ",s);let r=Math.ceil(Math.ceil(Math.max(1,i.width)+2*s.padding)*e),n=Math.ceil(Math.ceil(Math.max(1,i.height)+2*s.padding)*e);return r=Math.ceil(r-1e-6),n=Math.ceil(n-1e-6),r=(0,l.U5)(r),n=(0,l.U5)(n),{width:r,height:n}}getTexture(t,e,s,i){"string"==typeof t&&((0,g.t)("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),t={text:t,style:s,resolution:e}),t.style instanceof x.x||(t.style=new x.x(t.style));const{texture:r,canvasAndContext:n}=this.createTextureAndCanvas(t);return this._renderer.texture.initSource(r._source),c.N.returnCanvasAndContext(n),r}createTextureAndCanvas(t){const{text:e,style:s}=t,i=t.resolution??this._renderer.resolution,r=_.P.measureText(e||" ",s),n=Math.ceil(Math.ceil(Math.max(1,r.width)+2*s.padding)*i),a=Math.ceil(Math.ceil(Math.max(1,r.height)+2*s.padding)*i),o=c.N.getOptimalCanvasAndContext(n,a),{canvas:h}=o;this.renderTextToCanvas(e,s,i,o);const l=(0,m.M)(h,n,a,i);if(s.trim){const t=function(t,e=1){const{width:s,height:i}=t,r=t.getContext("2d",{willReadFrequently:!0});if(null===r)throw new TypeError("Failed to get canvas 2D context");const n=r.getImageData(0,0,s,i).data;let a=0,o=0,h=s-1,l=i-1;for(;o<i&&p(n,s,o);)++o;if(o===i)return d.M.EMPTY;for(;p(n,s,l);)--l;for(;f(n,s,a,o,l);)++a;for(;f(n,s,h,o,l);)--h;return++h,++l,new d.M(a/e,o/e,(h-a)/e,(l-o)/e)}(h,i);l.frame.copyFrom(t),l.updateUvs()}return{texture:l,canvasAndContext:o}}getManagedTexture(t){const e=t._getKey();if(this._activeTextures[e])return this._increaseReferenceCount(e),this._activeTextures[e].texture;const{texture:s,canvasAndContext:i}=this.createTextureAndCanvas(t);return this._activeTextures[e]={canvasAndContext:i,texture:s,usageCount:1},s}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){const e=this._activeTextures[t];if(e.usageCount--,0===e.usageCount){c.N.returnCanvasAndContext(e.canvasAndContext),u.W.returnTexture(e.texture);const s=e.texture.source;s.resource=null,s.uploadMethodId="unknown",s.alphaMode="no-premultiply-alpha",this._activeTextures[t]=null}}getReferenceCount(t){return this._activeTextures[t].usageCount}renderTextToCanvas(t,e,s,i){const{canvas:r,context:n}=i,a=(0,y.Z)(e),o=_.P.measureText(t||" ",e),l=o.lines,c=o.lineHeight,u=o.lineWidths,d=o.maxLineWidth,p=o.fontProperties,f=r.height;n.resetTransform(),n.scale(s,s);const g=2*e.padding;if(n.clearRect(0,0,o.width+4+g,o.height+4+g),e._stroke?.width){const t=e._stroke;n.lineWidth=t.width,n.miterLimit=t.miterLimit,n.lineJoin=t.join,n.lineCap=t.cap}let x,m;n.font=a;const S=e.dropShadow?2:1;for(let t=0;t<S;++t){const r=e.dropShadow&&0===t,a=r?Math.ceil(Math.max(1,f)+2*e.padding):0,o=a*s;if(r){n.fillStyle="black",n.strokeStyle="black";const t=e.dropShadow,i=t.color,r=t.alpha;n.shadowColor=h.Q.shared.setValue(i).setAlpha(r).toRgbaString();const a=t.blur*s,l=t.distance*s;n.shadowBlur=a,n.shadowOffsetX=Math.cos(t.angle)*l,n.shadowOffsetY=Math.sin(t.angle)*l+o}else n.globalAlpha=e._fill?.alpha??1,n.fillStyle=e._fill?(0,b.r)(e._fill,n):null,e._stroke?.width&&(n.strokeStyle=(0,b.r)(e._stroke,n)),n.shadowColor="black";let g=(c-p.fontSize)/2;c-p.fontSize<0&&(g=0);const _=e._stroke?.width??0;for(let t=0;t<l.length;t++)x=_/2,m=_/2+t*c+p.ascent+g,"right"===e.align?x+=d-u[t]:"center"===e.align&&(x+=(d-u[t])/2),e._stroke?.width&&this._drawLetterSpacing(l[t],e,i,x+e.padding,m+e.padding-a,!0),void 0!==e._fill&&this._drawLetterSpacing(l[t],e,i,x+e.padding,m+e.padding-a)}}_drawLetterSpacing(t,e,s,i,r,n=!1){const{context:a}=s,o=e.letterSpacing;let h=!1;if(_.P.experimentalLetterSpacingSupported&&(_.P.experimentalLetterSpacing?(a.letterSpacing=`${o}px`,a.textLetterSpacing=`${o}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),0===o||h)return void(n?a.strokeText(t,i,r):a.fillText(t,i,r));let l=i;const c=_.P.graphemeSegmenter(t);let u=a.measureText(t).width,d=0;for(let t=0;t<c.length;++t){const e=c[t];n?a.strokeText(e,l,r):a.fillText(e,l,r);let s="";for(let e=t+1;e<c.length;++e)s+=c[e];d=a.measureText(s).width,l+=u-d+o,u=d}}destroy(){this._activeTextures=null}}S.extension={type:[i.Ag.WebGLSystem,i.Ag.WebGPUSystem,i.Ag.CanvasSystem],name:"canvasText"},i.XO.add(S),i.XO.add(o)},8011:(t,e,s)=>{"use strict";s.d(e,{V:()=>r});const i=["_fontFamily","_fontStyle","_fontSize","_fontVariant","_fontWeight","_breakWords","_align","_leading","_letterSpacing","_lineHeight","_textBaseline","_whiteSpace","_wordWrap","_wordWrapWidth","_padding","_cssOverrides","_trim"];function r(t){const e=[];let s=0;for(let r=0;r<i.length;r++){const n=i[r];e[s++]=t[n]}return s=n(t._fill,e,s),s=function(t,e,s){return t?(s=n(t,e,s),e[s++]=t.width,e[s++]=t.alignment,e[s++]=t.cap,e[s++]=t.join,e[s++]=t.miterLimit,s):s}(t._stroke,e,s),e.join("-")}function n(t,e,s){return t?(e[s++]=t.color,e[s++]=t.alpha,e[s++]=t.fill?.uid,s):s}},2558:(t,e,s)=>{"use strict";s.d(e,{M:()=>n});var i=s(2437);const r=new(s(9636).c);function n(t,e,s,n){const a=r;a.minX=0,a.minY=0,a.maxX=t.width/n|0,a.maxY=t.height/n|0;const o=i.W.getOptimalTexture(a.width,a.height,n,!1);return o.source.uploadMethodId="image",o.source.resource=t,o.source.alphaMode="premultiply-alpha-on-upload",o.frame.width=e/n,o.frame.height=s/n,o.source.emit("update",o.source),o.updateUvs(),o}}}]);